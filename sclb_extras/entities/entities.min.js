var Kinetic={GlobalObject:{stages:[],idCounter:0,extend:function(c,b){for(var a in b.prototype)b.prototype.hasOwnProperty(a)&&(c.prototype[a]=b.prototype[a])}},Node:function(a){this.visible=!0,this.isListening=!0,this.name=a,this.x=0,this.y=0,this.scale={x:1,y:1},this.rotation=0,this.eventListeners={},this.drag={x:!1,y:!1,moving:!1},this.alpha=1}};Kinetic.Node.prototype={on:function(c,i){for(var g=c.split(" "),d=0;d<g.length;d++){var h=g[d],f=(-1===h.indexOf("touch")?"on"+h:h).split("."),e=f[0],a=f.length>1?f[1]:"";this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push({name:a,handler:i})}},off:function(b){for(var h=b.split(" "),d=0;d<h.length;d++){var j=h[d],f=(-1===j.indexOf("touch")?"on"+j:j).split("."),e=f[0];if(this.eventListeners[e]&&f.length>1){for(var c=f[1],g=0;g<this.eventListeners[e].length;g++)if(this.eventListeners[e][g].name===c){this.eventListeners[e].splice(g,1),0===this.eventListeners[e].length&&(this.eventListeners[e]=void 0);break}}else this.eventListeners[e]=void 0}},show:function(){this.visible=!0},hide:function(){this.visible=!1},getZIndex:function(){return this.index},setScale:function(b,a){a?(this.scale.x=b,this.scale.y=a):(this.scale.x=b,this.scale.y=b)},getScale:function(){return this.scale},setPosition:function(a,b){this.x=a,this.y=b},getPosition:function(){return{x:this.x,y:this.y}},getAbsolutePosition:function(){for(var a=this.x,c=this.y,b=this.getParent();"Stage"!==b.className;)a+=b.x,c+=b.y,b=b.parent;return{x:a,y:c}},move:function(a,b){this.x+=a,this.y+=b},setRotation:function(a){this.rotation=a},getRotation:function(){return this.rotation},rotate:function(a){this.rotation+=a},listen:function(a){this.isListening=a},moveToTop:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.push(this),this.parent._setChildrenIndices()},moveUp:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.splice(a+1,0,this),this.parent._setChildrenIndices()},moveDown:function(){var a=this.index;a>0&&(this.parent.children.splice(a,1),this.parent.children.splice(a-1,0,this),this.parent._setChildrenIndices())},moveToBottom:function(){var a=this.index;this.parent.children.splice(a,1),this.parent.children.unshift(this),this.parent._setChildrenIndices()},setZIndex:function(b){var a=this.index;this.parent.children.splice(a,1),this.parent.children.splice(b,0,this),this.parent._setChildrenIndices()},setAlpha:function(a){this.alpha=a},getAlpha:function(){return this.alpha},getAbsoluteAlpha:function(){for(var b=1,a=this;"Stage"!==a.className;)b*=a.alpha,a=a.parent;return b},_initDrag:function(){var a=this;this.on("mousedown.initdrag touchstart.initdrag",function(b){var c=a.getStage(),d=c.getUserPosition();d&&(c.nodeDragging=a,c.nodeDragging.offset={},c.nodeDragging.offset.x=d.x-a.x,c.nodeDragging.offset.y=d.y-a.y)})},_dragCleanup:function(){this.drag.x||this.drag.y||(this.off("mousedown.initdrag"),this.off("touchstart.initdrag"))},draggable:function(b){if(b){var a=!this.drag.x&&!this.drag.y;this.drag.x=!0,this.drag.y=!0,a&&this._initDrag()}else this.drag.x=!1,this.drag.y=!1,this._dragCleanup()},draggableX:function(b){if(b){var a=!this.drag.x&&!this.drag.y;this.drag.x=!0,a&&this._initDrag()}else this.drag.x=!1,this._dragCleanup()},draggableY:function(b){if(b){var a=!this.drag.x&&!this.drag.y;this.drag.y=!0,a&&this._initDrag()}else this.drag.y=!1,this._dragCleanup()},isDragging:function(){return this.drag.moving},_handleEvents:function(b,a){!function c(g){var f=g.eventListeners;if(f[b])for(var e=f[b],d=0;d<e.length;d++)e[d].handler.apply(g,[a]);"Stage"!==g.parent.className&&c(g.parent)}(this)},moveTo:function(b){var a=this.parent;a.children.splice(this.index,1),a._setChildrenIndices(),b.children.push(this),this.index=b.children.length-1,this.parent=b,b._setChildrenIndices(),this.name&&(a.childrenNames[this.name]=void 0,b.childrenNames[this.name]=this)},getParent:function(){return this.parent},getLayer:function(){return"Layer"===this.className?this:this.getParent().getLayer()},getStage:function(){return this.getParent().getStage()},getName:function(){return this.name}},Kinetic.Container=function(){this.children=[],this.childrenNames={}},Kinetic.Container.prototype={_setChildrenIndices:function(){if("Stage"===this.className){var c=this.container.childNodes,a=c[0],b=c[1];this.container.innerHTML="",this.container.appendChild(a),this.container.appendChild(b)}for(var d=0;d<this.children.length;d++)this.children[d].index=d,"Stage"===this.className&&this.container.appendChild(this.children[d].canvas)},_drawChildren:function(){for(var a=this.children,c=0;c<a.length;c++){var b=a[c];"Shape"===b.className?b._draw(b.getLayer()):b._draw()}},getChildren:function(){return this.children},getChild:function(a){return this.childrenNames[a]},_add:function(a){a.name&&(this.childrenNames[a.name]=a),a.id=Kinetic.GlobalObject.idCounter++,a.index=this.children.length,a.parent=this,this.children.push(a)},_remove:function(a){void 0!==a.name&&(this.childrenNames[a.name]=void 0),this.children.splice(a.index,1),this._setChildrenIndices(),a=void 0}},Kinetic.Stage=function(b,c,a,o){this.className="Stage",this.container="string"==typeof b?document.getElementById(b):b,this.width=c,this.height=a,this.scale={x:1,y:1},this.customOptions=o||{},this.dblClickWindow=400,this.targetShape=void 0,this.clickStart=!1,this.mousePos=void 0,this.mouseDown=!1,this.mouseUp=!1,this.touchPos=void 0,this.touchStart=!1,this.touchEnd=!1,this.bufferLayer=new Kinetic.Layer,this.backstageLayer=new Kinetic.Layer,this.bufferLayer.parent=this,this.backstageLayer.parent=this;var e=this.backstageLayer;this._stripLayer(e),this.bufferLayer.getCanvas().style.display="none",this.backstageLayer.getCanvas().style.display="none",this.bufferLayer.canvas.width=this.width,this.bufferLayer.canvas.height=this.height,this.container.appendChild(this.bufferLayer.canvas),this.backstageLayer.canvas.width=this.width,this.backstageLayer.canvas.height=this.height,this.container.appendChild(this.backstageLayer.canvas),this._listen(),this._prepareDrag(),Kinetic.GlobalObject.stages.push(this),this.id=Kinetic.GlobalObject.idCounter++,Kinetic.Container.apply(this,[])},Kinetic.Stage.prototype={draw:function(){this._drawChildren()},_stripLayer:function(a){a.context.stroke=function(){},a.context.fill=function(){},a.context.fillRect=function(c,e,d,b){a.context.rect(c,e,d,b)},a.context.strokeRect=function(c,e,d,b){a.context.rect(c,e,d,b)},a.context.drawImage=function(){},a.context.fillText=function(){},a.context.strokeText=function(){}},_endDrag:function(a){this.nodeDragging&&this.nodeDragging.drag.moving&&(this.nodeDragging.drag.moving=!1,this.nodeDragging._handleEvents("ondragend",a)),this.nodeDragging=void 0},_prepareDrag:function(){var a=this;this.on("mousemove touchmove",function(b){if(a.nodeDragging){var c=a.getUserPosition();a.nodeDragging.drag.x&&(a.nodeDragging.x=c.x-a.nodeDragging.offset.x),a.nodeDragging.drag.y&&(a.nodeDragging.y=c.y-a.nodeDragging.offset.y),a.nodeDragging.getLayer().draw(),a.nodeDragging.drag.moving||(a.nodeDragging.drag.moving=!0,a.nodeDragging._handleEvents("ondragstart",b)),a.nodeDragging._handleEvents("ondragmove",b)}},!1),this.on("mouseup touchend mouseout",function(b){a._endDrag(b)})},setSize:function(c,a){for(var d=this.children,e=0;e<d.length;e++){var b=d[e];b.getCanvas().width=c,b.getCanvas().height=a,b.draw()}this.width=c,this.height=a,this.bufferLayer.getCanvas().width=c,this.bufferLayer.getCanvas().height=a,this.backstageLayer.getCanvas().width=c,this.backstageLayer.getCanvas().height=a},setScale:function(d,c){var b=this.scale.x,a=this.scale.y;c?(this.scale.x=d,this.scale.y=c):(this.scale.x=d,this.scale.y=d);var e=this;!function g(j){for(var h=0;h<j.length;h++){var k=j[h];k.x*=e.scale.x/b,k.y*=e.scale.y/a,k.children&&g(k.children)}}(this.children)},getScale:function(){return this.scale},clear:function(){for(var a=this.children,b=0;b<a.length;b++)a[b].clear()},toDataURL:function(e){var b=this.bufferLayer,a=b.getContext(),d=this.children;b.clear(),function c(h){var g=d[h].getCanvas().toDataURL(),f=new Image;f.onload=function(){a.drawImage(this,0,0),++h<d.length?c(h):e(b.getCanvas().toDataURL())},f.src=g}(0)},remove:function(a){this.container.removeChild(a.canvas),this._remove(a)},on:function(b,d){for(var c=b.split(" "),e=0;e<c.length;e++){var a=c[e];this.container.addEventListener(a,d,!1)}},add:function(a){a.name&&(this.childrenNames[a.name]=a),a.canvas.width=this.width,a.canvas.height=this.height,this._add(a),a.draw(),this.container.appendChild(a.canvas)},_handleEvent:function(i){if(this.customOptions.dragDebounce){if(this.dragTimeout)return;this._handleEventForDraw(i),this.dragTimeout=null}else this._handleEventForDraw(i)},_handleEventForDraw:function(i){i||(i=window.event),void 0!==i.touches&&1===i.touches.length?this._setTouchPosition(i):this._setMousePosition(i);var c=this.backstageLayer,f=c.getContext(),g=this;c.clear();function d(j){j._draw(c);var o=g.getUserPosition(),n=j.eventListeners;if(j.visible&&void 0!==o&&f.isPointInPath(o.x,o.y)){if(g.mouseDown)return g.mouseDown=!1,g.clickStart=!0,j._handleEvents("onmousedown",i),!0;if(g.mouseUp)return g.mouseUp=!1,j._handleEvents("onmouseup",i),g.clickStart&&(g.nodeDragging&&!g.nodeDragging.drag.moving||!g.nodeDragging)&&(j._handleEvents("onclick",i),j.inDoubleClickWindow&&j._handleEvents("ondblclick",i),j.inDoubleClickWindow=!0,setTimeout(function(){j.inDoubleClickWindow=!1},g.dblClickWindow)),!0;if(g.touchStart){if(g.touchStart=!1,j._handleEvents("touchstart",i),n.ondbltap&&j.inDoubleClickWindow)for(var m=n.ondbltap,l=0;l<m.length;l++)m[l].handler.apply(j,[i]);return j.inDoubleClickWindow=!0,setTimeout(function(){j.inDoubleClickWindow=!1},g.dblClickWindow),!0}if(g.touchEnd)return g.touchEnd=!1,j._handleEvents("touchend",i),!0;if(n.touchmove)return j._handleEvents("touchmove",i),!0;if(!g.targetShape||g.targetShape&&g.targetShape.id!==j.id&&g.targetShape.getZIndex()<j.getZIndex()){if(g.targetShape)g.targetShape.eventListeners&&g.targetShape._handleEvents("onmouseout",i);return g.targetShape=j,j._handleEvents("onmouseover",i),!0}return j._handleEvents("onmousemove",i),!0}return!(!g.targetShape||g.targetShape.id!==j.id)&&(g.targetShape=void 0,j._handleEvents("onmouseout",i),!0)}function b(m){for(var l=m.children,k=l.length-1;k>=0;k--){0;var n=l[k];if("Shape"===n.className){if(d(n))return!0}else b(n)}return!1}for(var a=this.children.length-1;a>=0;a--){var e=this.children[a];e.visible&&a>=0&&e.isListening&&b(e)&&(a=-1)}},_listen:function(){var a=this,mouseMove=!1;this.container.addEventListener("mousedown",function(b){a.mouseDown=!0,a._handleEvent(b),mouseMove=!0},!1),this.container.addEventListener("mousemove",function(b){a.customOptions.dragDebounce&&!mouseMove||(a.mouseDown=!1,a.mouseUp=!1,a._handleEvent(b))},!1),this.container.addEventListener("mouseup",function(b){a.mouseUp=!0,a.mouseDown=!1,mouseMove=!1,a._handleEvent(b),a.clickStart=!1},!1),this.customOptions.dragDebounce||this.container.addEventListener("mouseover",function(b){a._handleEvent(b)},!1),this.container.addEventListener("mouseout",function(b){a.mousePos=void 0},!1),this.container.addEventListener("touchstart",function(b){b.preventDefault(),a.touchStart=!0,a._handleEvent(b)},!1),this.container.addEventListener("touchmove",function(b){b.preventDefault(),a._handleEvent(b)},!1),this.container.addEventListener("touchend",function(b){b.preventDefault(),a.touchEnd=!0,a._handleEvent(b)},!1)},getMousePosition:function(a){return this.mousePos},getTouchPosition:function(a){return this.touchPos},getUserPosition:function(a){return this.getTouchPosition()||this.getMousePosition()},_setMousePosition:function(a){this.mousePos={x:a.offsetX,y:a.offsetY}},_setTouchPosition:function(c){for(var d=c.touches[0],b=d.clientX-this._getContainerPosition().left+window.pageXOffset,a=d.clientY-this._getContainerPosition().top+window.pageYOffset;b<0;)b+=$(window).width();this.touchPos={x:b,y:a}},_getContainerPosition:function(){for(var c=this.container,b=0,a=0;c&&"BODY"!==c.tagName;)b+=c.offsetTop,a+=c.offsetLeft,c=c.offsetParent;return{top:b,left:a}},getContainer:function(){return this.container},getStage:function(){return this},getTargetShape:function(){return this.targetShape}},Kinetic.GlobalObject.extend(Kinetic.Stage,Kinetic.Container),Kinetic.Layer=function(a){this.className="Layer",this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.style.position="absolute",Kinetic.Container.apply(this,[]),Kinetic.Node.apply(this,[a])},Kinetic.Layer.prototype={draw:function(){this._draw()},_draw:function(){this.clear(),this.visible&&this._drawChildren()},clear:function(){var b=this.getContext(),a=this.getCanvas();b.clearRect(0,0,a.width,a.height)},getCanvas:function(){return this.canvas},getContext:function(){return this.context},add:function(a){this._add(a)},remove:function(a){this._remove(a)}},Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Container),Kinetic.GlobalObject.extend(Kinetic.Layer,Kinetic.Node),Kinetic.Group=function(a){this.className="Group",Kinetic.Container.apply(this,[]),Kinetic.Node.apply(this,[a])},Kinetic.Group.prototype={_draw:function(){this.visible&&this._drawChildren()},add:function(a){this._add(a)},remove:function(a){this._remove(a)}},Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Container),Kinetic.GlobalObject.extend(Kinetic.Group,Kinetic.Node),Kinetic.Shape=function(b,a){this.className="Shape",this.drawFunc=b,Kinetic.Node.apply(this,[a])},Kinetic.Shape.prototype={getContext:function(){return this.tempLayer.getContext()},getCanvas:function(){return this.tempLayer.getCanvas()},_draw:function(d){if(this.visible){for(var a=d.getStage(),c=d.getContext(),f=[this],e=this.parent;"Stage"!==e.className;)f.push(e),e=e.parent;for(var h=f.length;h--;){var g=f[h];c.save(),0===g.x&&0===g.y||c.translate(g.x,g.y),0!==g.rotation&&c.rotate(g.rotation),1===g.scale.x&&1===g.scale.y||c.scale(g.scale.x,g.scale.y),1!==g.getAbsoluteAlpha()&&(c.globalAlpha=g.getAbsoluteAlpha())}c.save(),!a||1===a.scale.x&&1===a.scale.y||c.scale(a.scale.x,a.scale.y),this.tempLayer=d,this.drawFunc(),c.restore()}}},Kinetic.GlobalObject.extend(Kinetic.Shape,Kinetic.Node),function($){var initializing=!1,makeArray=$.makeArray,isFunction=$.isFunction,isArray=$.isArray,extend=$.extend,getObject=$.String.getObject,concatArgs=function(arr,args){return arr.concat(makeArray(args))},fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,inheritProps=function(newProps,oldProps,addTo){for(var name in addTo=addTo||newProps,newProps)addTo[name]=isFunction(newProps[name])&&isFunction(oldProps[name])&&fnTest.test(newProps[name])?function(name,fn){return function(){var ret,tmp=this._super;return this._super=oldProps[name],ret=fn.apply(this,arguments),this._super=tmp,ret}}(name,newProps[name]):newProps[name]};clss=$.Class=function(){arguments.length&&clss.extend.apply(clss,arguments)},extend(clss,{proxy:function(funcs){var self,args=makeArray(arguments);return funcs=args.shift(),isArray(funcs)||(funcs=[funcs]),self=this,function(){for(var isString,func,cur=concatArgs(args,arguments),length=funcs.length,f=0;f<length;f++)(func=funcs[f])&&((isString="string"==typeof func)&&self._set_called&&(self.called=func),cur=(isString?self[func]:func).apply(self,cur||[]),f<length-1&&(cur=!isArray(cur)||cur._use_call?[cur]:cur));return cur}},newInstance:function(){var args,inst=this.rawInstance();return inst.setup&&(args=inst.setup.apply(inst,arguments)),inst.init&&inst.init.apply(inst,isArray(args)?args:arguments),inst},setup:function(baseClass,fullName){return this.defaults=extend(!0,{},baseClass.defaults,this.defaults),arguments},rawInstance:function(){initializing=!0;var inst=new this;return initializing=!1,inst},extend:function(fullName,klass,proto){"string"!=typeof fullName&&(proto=klass,klass=fullName,fullName=null),proto||(proto=klass,klass=null),proto=proto||{};var name,prototype,_super=this.prototype;function Class(){if(!initializing)return this.constructor!==Class&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.Class.newInstance.apply(this.Class,arguments)}for(name in initializing=!0,prototype=new this,initializing=!1,inheritProps(proto,_super,prototype),this)this.hasOwnProperty(name)&&(Class[name]=this[name]);if(inheritProps(klass,this,Class),fullName){var parts=fullName.split(/\./),shortName=parts.pop(),current=getObject(parts.join("."),window,!0),namespace=current;current[shortName]=Class}extend(Class,{prototype:prototype,namespace:namespace,shortName:shortName,constructor:Class,fullName:fullName}),Class.prototype.Class=Class.prototype.constructor=Class;var args=Class.setup.apply(Class,concatArgs([this],arguments));return Class.init&&Class.init.apply(Class,args||[]),Class}}),clss.callback=clss.prototype.callback=clss.prototype.proxy=clss.proxy}(jQuery),function($){var $view,checkText,get,convert,modify,isTemplate,isHTML,getCallback,hookupView,funcs,toId=function(src){return src.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},id=1,isDeferred=function(obj){return obj&&$.isFunction(obj.always)},usefulPart=function(resolved){return $.isArray(resolved)&&3===resolved.length&&"success"===resolved[1]?resolved[0]:resolved};$view=$.View=function(view,data,helpers,callback){"function"==typeof helpers&&(callback=helpers,helpers=void 0);var deferreds=function(data){var deferreds=[];if(isDeferred(data))return[data];for(var prop in data)isDeferred(data[prop])&&deferreds.push(data[prop]);return deferreds}(data);if(deferreds.length){var deferred=$.Deferred();return deferreds.push(get(view,!0)),$.when.apply($,deferreds).then(function(resolved){var result,objs=$.makeArray(arguments),renderer=objs.pop()[0];if(isDeferred(data))data=usefulPart(resolved);else for(var prop in data)isDeferred(data[prop])&&(data[prop]=usefulPart(objs.shift()));result=renderer(data,helpers),deferred.resolve(result),callback&&callback(result)}),deferred.promise()}var response,async="function"==typeof callback;deferred=get(view,async);return async?(response=deferred,deferred.done(function(renderer){callback(renderer(data,helpers))})):deferred.done(function(renderer){response=renderer(data,helpers)}),response},checkText=function(text,url){if(!text.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+url},get=function(url,async){return $.ajax({url:url,dataType:"view",async:async})},$.ajaxTransport("view",function(options,orig){var type,el,id,jqXHR,view=orig.url,suffix=view.match(/\.[\w\d]+$/),url=view,response=function(text){var func=type.renderer(id,text);return $view.cache&&($view.cached[id]=func),{view:func}};return(el=document.getElementById(view))&&(suffix=el.type.match(/\/[\d\w]+$/)[0].replace(/^\//,".")),suffix||(suffix=$view.ext,url+=$view.ext),id=toId(url),url.match(/^\/\//)&&(url="undefined"==typeof steal?"/"+url.substr(2):steal.root.mapJoin(url.substr(2))),type=$view.types[suffix],{send:function(headers,callback){if($view.cached[id])return callback(200,"success",{view:$view.cached[id]});el?callback(200,"success",response(el.innerHTML)):jqXHR=$.ajax({async:orig.async,url:url,dataType:"text",error:function(){checkText("",url),callback(404)},success:function(text){checkText(text,url),callback(200,"success",response(text))}})},abort:function(){jqXHR&&jqXHR.abort()}}}),$.extend($view,{hookups:{},hookup:function(cb){var myid=++id;return $view.hookups[myid]=cb,myid},cached:{},cache:!0,register:function(info){this.types["."+info.suffix]=info,window.steal&&steal.type(info.suffix+" view js",function(options,orig,success,error){var type=$view.types["."+options.type],id=toId(options.rootSrc);options.text=type.script(id,options.text),success()})},types:{},ext:".ejs",registerScript:function(type,id,src){return"$.View.preload('"+id+"',"+$view.types["."+type].script(id,src)+");"},preload:function(id,renderer){$view.cached[id]=function(data,helpers){return renderer.call(data,data,helpers)}}}),window.steal&&steal.type("view js",function(options,orig,success,error){var type=$view.types["."+options.type],id=toId(options.rootSrc);options.text="steal('"+(type.plugin||"jquery/view/"+options.type)+"').then(function($){$.View.preload('"+id+"',"+options.text+");\n})",success()}),convert=function(func_name){var old=$.fn[func_name];$.fn[func_name]=function(){var callbackNum,callback,result,args=$.makeArray(arguments),self=this;if(isDeferred(args[0]))return args[0].done(function(res){modify.call(self,[res],old)}),this;if(isTemplate(args)){if(callbackNum=getCallback(args))return callback=args[callbackNum],args[callbackNum]=function(result){modify.call(self,[result],old),callback.call(self,result)},$view.apply($view,args),this;if(result=$view.apply($view,args),isDeferred(result))return result.done(function(res){modify.call(self,[res],old)}),this;args=[result]}return modify.call(this,args,old)}},modify=function(args,old){var res,hooks;for(var hasHookups in $view.hookups)break;return hasHookups&&args[0]&&isHTML(args[0])&&(hooks=$view.hookups,$view.hookups={},args[0]=$(args[0])),res=old.apply(this,args),hooks&&hookupView(args[0],hooks),res},isTemplate=function(args){var secArgType=typeof args[1];return!("string"!=typeof args[0]||"object"!=secArgType&&"function"!=secArgType||args[1].nodeType||args[1].jquery)},isHTML=function(arg){return!(!arg.jquery&&1!==arg.nodeType)||"string"==typeof arg&&("<"===(arg=$.trim(arg)).substr(0,1)&&">"===arg.substr(arg.length-1,1)&&arg.length>=3)},getCallback=function(args){return"function"==typeof args[3]?3:"function"==typeof args[2]&&2},hookupView=function(els,hooks){var hookupEls,len,id,func,i=0;for(len=(hookupEls=(els=els.filter(function(){return 3!=this.nodeType})).add("[data-view-id]",els)).length;i<len;i++)hookupEls[i].getAttribute&&(id=hookupEls[i].getAttribute("data-view-id"))&&(func=hooks[id])&&(func(hookupEls[i],id),delete hooks[id],hookupEls[i].removeAttribute("data-view-id"));$.extend($view.hookups,hooks)},$.fn.hookup=function(){var hooks=$view.hookups;return $view.hookups={},hookupView(this,hooks),this},funcs=["prepend","append","after","before","text","html","replaceWith","val"];for(var i=0;i<funcs.length;i++)convert(funcs[i])}(jQuery),function($){var makeArray=$.makeArray,isArray=$.isArray,isFunction=$.isFunction,extend=$.extend,Str=$.String,each=$.each,slice=Array.prototype.slice,binder=function(el,ev,callback,selector){return selector?function(el,selector,ev,callback){var binder=el.delegate&&el.undelegate?el:$(isFunction(el)?[el]:el);return binder.delegate(selector,ev,callback),function(){binder.undelegate(selector,ev,callback),binder=el=ev=callback=selector=null}}(el,selector,ev,callback):function(el,ev,callback){var wrappedCallback,binder=el.bind&&el.unbind?el:$(isFunction(el)?[el]:el);return 0===ev.indexOf(">")&&(ev=ev.substr(1),wrappedCallback=function(event){event.target===el&&callback.apply(this,arguments)}),binder.bind(ev,wrappedCallback||callback),function(){binder.unbind(ev,wrappedCallback||callback),el=ev=callback=wrappedCallback=null}}(el,ev,callback)},shifter=function(context,name){var method="string"==typeof name?context[name]:name;return function(){return context.called=name,method.apply(context,[this.nodeName?$(this):this].concat(slice.call(arguments,0)))}},dotsReg=/\./g,controllersReg=/_?controllers?/gi,underscoreAndRemoveController=function(className){return Str.underscore(className.replace("jQuery.","").replace(dotsReg,"_").replace(controllersReg,""))},actionMatcher=/[^\w]/,parameterReplacer=/\{([^\}]+)\}/g,breaker=/^(?:(.*?)\s)?([\w\.\:>]+)$/,data=function(el,data){return $.data(el,"controllers",data)};$.Class("jQuery.Controller",{setup:function(){if(this._super.apply(this,arguments),this.shortName&&"jQuery.Controller"!=this.fullName){this._fullName=underscoreAndRemoveController(this.fullName),this._shortName=underscoreAndRemoveController(this.shortName);var funcName,controller=this,pluginname=this.pluginName||this._fullName;for(funcName in $.fn[pluginname]||($.fn[pluginname]=function(options){var args=makeArray(arguments),isMethod="string"==typeof options&&isFunction(controller.prototype[options]),meth=args[0];return this.each(function(){var controllers=data(this),plugin=controllers&&controllers[pluginname];plugin?isMethod?plugin[meth].apply(plugin,args.slice(1)):plugin.update.apply(plugin,args):controller.newInstance.apply(controller,[this].concat(args))})}),this.actions={},this.prototype)"constructor"!=funcName&&isFunction(this.prototype[funcName])&&this._isAction(funcName)&&(this.actions[funcName]=this._action(funcName))}},hookup:function(el){return new this(el)},_isAction:function(methodName){return!!actionMatcher.test(methodName)||($.inArray(methodName,this.listensTo)>-1||$.event.special[methodName]||processors[methodName])},_action:function(methodName,options){if(parameterReplacer.lastIndex=0,!options&&parameterReplacer.test(methodName))return null;var convertedName=options?Str.sub(methodName,[options,window]):methodName,arr=isArray(convertedName),parts=(arr?convertedName[1]:convertedName).match(breaker),event=parts[2];return{processor:processors[event]||basicProcessor,parts:parts,delegate:arr?convertedName[0]:void 0}},processors:{},listensTo:[],defaults:{}},{setup:function(element,options){var cls=this.constructor;element=element.jquery?element[0]:element;var pluginname=cls.pluginName||cls._fullName;return this.element=$(element).addClass(pluginname),(data(element)||data(element,{}))[pluginname]=this,this.options=extend(extend(!0,{},cls.defaults),options),this.called="init",this.bind(),this.element},bind:function(el,eventName,func){if(void 0===el){this._bindings=[];var cls=this.constructor,bindings=this._bindings,actions=cls.actions,element=this.element;for(funcName in actions)actions.hasOwnProperty(funcName)&&(ready=actions[funcName]||cls._action(funcName,this.options),bindings.push(ready.processor(ready.delegate||element,ready.parts[2],ready.parts[1],funcName,this)));var destroyCB=shifter(this,"destroy");return element.bind("destroyed",destroyCB),bindings.push(function(el){$(el).unbind("destroyed",destroyCB)}),bindings.length}return"string"==typeof el&&(func=eventName,eventName=el,el=this.element),this._binder(el,eventName,func)},_binder:function(el,eventName,func,selector){return"string"==typeof func&&(func=shifter(this,func)),this._bindings.push(binder(el,eventName,func,selector)),this._bindings.length},_unbind:function(){var el=this.element[0];each(this._bindings,function(key,value){value(el)}),this._bindings=[]},delegate:function(element,selector,eventName,func){return"string"==typeof element&&(func=eventName,eventName=selector,selector=element,element=this.element),this._binder(element,eventName,func,selector)},update:function(options){extend(this.options,options),this._unbind(),this.bind()},destroy:function(){if(this._destroyed)throw this.constructor.shortName+" controller already deleted";var fname=this.constructor.pluginName||this.constructor._fullName;this._destroyed=!0,this.element.removeClass(fname),this._unbind(),delete this._actions,delete this.element.data("controllers")[fname],$(this).triggerHandler("destroyed"),this.element=null},find:function(selector){return this.element.find(selector)},_set_called:!0});var processors=$.Controller.processors,basicProcessor=function(el,event,selector,methodName,controller){return binder(el,event,shifter(controller,methodName),selector)};each("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(i,v){processors[v]=basicProcessor});var i,isAControllerOf=function(instance,controllers){for(i=0;i<controllers.length;i++)if("string"==typeof controllers[i]?instance.constructor._shortName==controllers[i]:instance instanceof controllers[i])return!0;return!1};$.fn.extend({controllers:function(){var controllers,c,cname,controllerNames=makeArray(arguments),instances=[];return this.each(function(){for(cname in controllers=$.data(this,"controllers"))controllers.hasOwnProperty(cname)&&(c=controllers[cname],controllerNames.length&&!isAControllerOf(c,controllerNames)||instances.push(c))}),instances},controller:function(controller){return this.controllers.apply(this,arguments)[0]}})}(jQuery),function($){var underscore=$.String.underscore,classize=$.String.classize,isArray=$.isArray,makeArray=$.makeArray,extend=$.extend,each=$.each,reqType=/GET|POST|PUT|DELETE/i,ajax=function(ajaxOb,attrs,success,error,fixture,type,dataType){dataType=dataType||"json";var tmp,src="";if("string"==typeof ajaxOb){var sp=ajaxOb.indexOf(" ");sp>2&&sp<7?(tmp=ajaxOb.substr(0,sp),reqType.test(tmp)?type=tmp:dataType=tmp,src=ajaxOb.substr(sp+1)):src=ajaxOb}"object"==typeof attrs&&!isArray(attrs)&&(attrs=extend({},attrs));var url=$.String.sub(src,attrs,!0);return $.ajax({url:url,data:attrs,success:success,error:error,type:type||"post",dataType:dataType,fixture:fixture})},fixture=function(extra,or){var u=underscore(this.shortName),f="-"+u+(extra||"");return $.fixture&&$.fixture[f]?f:or||"//"+underscore(this.fullName).replace(/\.models\..*/,"").replace(/\./g,"/")+"/fixtures/"+u+(extra||"")+".json"},getList=function(type){return new(type||$.Model.List||Array)},getId=function(inst){return inst[inst.constructor.id]},makeRequest=function(self,type,success,error,method){var deferred=$.Deferred(),args=[self.serialize(),function(data){self[method||type+"d"](data),deferred.resolveWith(self,[self,data,type])},function(data){deferred.rejectWith(self,[data])}],constructor=self.constructor;return"destroy"==type&&args.shift(),"create"!==type&&args.unshift(getId(self)),deferred.then(success),deferred.fail(error),constructor[type].apply(constructor,args),deferred.promise()},isObject=function(obj){return"object"==typeof obj&&null!==obj&&obj},$method=function(name){return function(eventType,handler){return $.fn[name].apply($([this]),arguments),this}},bind=$method("bind"),unbind=$method("unbind");ajaxMethods={create:function(str){return function(attrs,success,error){return ajax(str,attrs,success,error,fixture.call(this,"Create","-restCreate"))}},update:function(str){return function(id,attrs,success,error){return ajax(str,function(attrs,id){attrs=attrs||{};var identity=this.id;return attrs[identity]&&attrs[identity]!==id&&(attrs["new"+$.String.capitalize(id)]=attrs[identity],delete attrs[identity]),attrs[identity]=id,attrs}.call(this,attrs,id),success,error,fixture.call(this,"Update","-restUpdate"),"put")}},destroy:function(str){return function(id,success,error){var attrs={};return attrs[this.id]=id,ajax(str,attrs,success,error,fixture.call(this,"Destroy","-restDestroy"),"delete")}},findAll:function(str){return function(params,success,error){return ajax(str||this.shortName+"s.json",params,success,error,fixture.call(this,"s"),"get","json "+this._shortName+".models")}},findOne:function(str){return function(params,success,error){return ajax(str,params,success,error,fixture.call(this),"get","json "+this._shortName+".model")}}},jQuery.Class("jQuery.Model",{setup:function(superClass,stat,proto){var self=this;if(each(["attributes","associations","validations"],function(i,name){self[name]&&superClass[name]!==self[name]||(self[name]={})}),each(["convert","serialize"],function(i,name){superClass[name]!=self[name]&&(self[name]=extend({},superClass[name],self[name]))}),this._fullName=underscore(this.fullName.replace(/\./g,"_")),this._shortName=underscore(this.shortName),"jQuery."!=this.fullName.substr(0,7)){for(var name in this.listType&&(this.list=new this.listType([])),ajaxMethods)"function"!=typeof this[name]&&(this[name]=ajaxMethods[name](this[name]));var converters={},convertName="* "+this._shortName+".model";converters[convertName+"s"]=this.proxy("models"),converters[convertName]=this.proxy("model"),$.ajaxSetup({converters:converters})}},attributes:{},model:function(attributes){return attributes?(attributes instanceof this&&(attributes=attributes.serialize()),new this(isObject(attributes[this._shortName])||isObject(attributes.data)||isObject(attributes.attributes)||attributes)):null},models:function(instancesRawData){if(!instancesRawData)return null;var res=getList(this.List),arr=isArray(instancesRawData),ml=$.Model.List&&instancesRawData instanceof $.Model.List,raw=arr?instancesRawData:ml?instancesRawData.serialize():instancesRawData.data,length=raw.length,i=0;for(res._use_call=!0;i<length;i++)res.push(this.model(raw[i]));if(!arr)for(var prop in instancesRawData)"data"!==prop&&(res[prop]=instancesRawData[prop]);return res},id:"id",addAttr:function(property,type){if(!this.associations[property])return this.attributes[property]||(this.attributes[property]=type),type},_models:{},publish:function(event,data){window.OpenAjax&&OpenAjax.hub.publish(this._shortName+"."+event,data)},guessType:function(){return"string"},convert:{date:function(str){var type=typeof str;return"string"===type?isNaN(Date.parse(str))?null:Date.parse(str):"number"===type?new Date(str):str},number:function(val){return parseFloat(val)},boolean:function(val){return Boolean(val)},default:function(val,error,type){var realType,construct=$.String.getObject(type),context=window;return type.indexOf(".")>=0&&(realType=type.substring(0,type.lastIndexOf(".")),context=$.String.getObject(realType)),"function"==typeof construct?construct.call(context,val):val}},serialize:{default:function(val,type){return isObject(val)&&val.serialize?val.serialize():val}},bind:bind,unbind:unbind,_ajax:ajax},{setup:function(attributes){this._init=!0,this.attrs(extend({},this.constructor.defaults,attributes)),delete this._init},update:function(attrs,success,error){return this.attrs(attrs),this.save(success,error)},errors:function(attrs){attrs&&(attrs=isArray(attrs)?attrs:makeArray(arguments));var errors={},self=this,validations=this.constructor.validations;for(var attr in each(attrs||validations||{},function(attr,funcs){"number"==typeof attr&&(funcs=validations[attr=funcs]),function(attr,funcs){each(funcs,function(i,func){var res=func.call(self);res&&(errors.hasOwnProperty(attr)||(errors[attr]=[]),errors[attr].push(res))})}(attr,funcs||[])}),errors)if(errors.hasOwnProperty(attr))return errors;return null},attr:function(attribute,value,success,error){var cap=classize(attribute),get="get"+cap;return void 0!==value?(this._setProperty(attribute,value,success,error,cap),this):this[get]?this[get]():this[attribute]},bind:bind,unbind:unbind,_setProperty:function(property,value,success,error,capitalized){var setName="set"+capitalized,old=this[property],self=this,errorCallback=function(errors){error&&error.call(self,errors),$(self).triggerHandler("error."+property,errors)};this[setName]&&void 0===(value=this[setName](value,this.proxy("_updateProperty",property,value,old,success,errorCallback),errorCallback))||this._updateProperty(property,value,old,success,errorCallback)},_updateProperty:function(property,value,old,success,errorCallback){var val,args,globalArgs,Class=this.constructor,type=Class.attributes[property]||Class.addAttr(property,Class.guessType(value)),converter=Class.convert[type]||Class.convert.default,errors=null,prefix="",global="updated.",callback=success,list=Class.list;val=this[property]=null===value?null:converter.call(Class,value,function(){},type),this._init||(errors=this.errors(property)),args=[val],globalArgs=[property,val,old],errors&&(prefix=global="error.",callback=errorCallback,globalArgs.splice(1,0,errors),args.unshift(errors)),old===val||this._init||(!errors&&$(this).triggerHandler(prefix+property,args),$(this).triggerHandler(global+"attr",globalArgs)),callback&&callback.apply(this,args),property===Class.id&&null!==val&&list&&(old?old!=val&&(list.remove(old),list.push(this)):list.push(this))},removeAttr:function(attr){var old=this[attr],deleted=!1,attrs=this.constructor.attributes;this[attr]&&delete this[attr],attrs[attr]&&(delete attrs[attr],deleted=!0),!this._init&&deleted&&old&&$(this).triggerHandler("updated.attr",[attr,null,old])},attrs:function(attributes){var key,constructor=this.constructor,attrs=constructor.attributes;if(attributes){var idName=constructor.id;for(key in attributes)key!=idName&&this.attr(key,attributes[key]);idName in attributes&&this.attr(idName,attributes[idName])}else for(key in attributes={},attrs)attrs.hasOwnProperty(key)&&(attributes[key]=this.attr(key));return attributes},serialize:function(){var type,converter,attr,Class=this.constructor,attrs=Class.attributes,data={};for(attr in attributes={},attrs)attrs.hasOwnProperty(attr)&&(type=attrs[attr],converter=Class.serialize[type]||Class.serialize.default,data[attr]=converter(this[attr],type));return data},isNew:function(){var id=getId(this);return void 0===id||null===id},save:function(success,error){return makeRequest(this,this.isNew()?"create":"update",success,error)},destroy:function(success,error){return makeRequest(this,"destroy",success,error,"destroyed")},identity:function(){var id=getId(this),constructor=this.constructor;return(constructor._fullName+"_"+(constructor.escapeIdentity?encodeURIComponent(id):id)).replace(/ /g,"_")},elements:function(context){return $("."+this.identity(),context)},publish:function(event,data){this.constructor.publish(event,data||this)},hookup:function(el){var shortName=this.constructor._shortName,models=$.data(el,"models")||$.data(el,"models",{});$(el).addClass(shortName+" "+this.identity()),models[shortName]=this}}),each(["created","updated","destroyed"],function(i,funcName){$.Model.prototype[funcName]=function(attrs){var constructor=this.constructor;return"destroyed"===funcName&&constructor.list&&constructor.list.remove(getId(this)),attrs&&"object"==typeof attrs&&this.attrs(attrs.attrs?attrs.attrs():attrs),$(this).triggerHandler(funcName),this.publish(funcName,this),$([constructor]).triggerHandler(funcName,this),[this].concat(makeArray(arguments))}}),$.fn.models=function(type){var kind,ret,collection=[];return this.each(function(){each($.data(this,"models")||{},function(name,instance){kind=void 0===kind?instance.constructor.List||null:instance.constructor.List===kind?kind:null,collection.push(instance)})}),(ret=getList(kind)).push.apply(ret,function(items){for(var collect=[],i=0;i<items.length;i++)items[i]["__u Nique"]||(collect.push(items[i]),items[i]["__u Nique"]=!0);for(i=0;i<collect.length;i++)delete collect[i]["__u Nique"];return collect}(collection)),ret},$.fn.model=function(type){return type&&type instanceof $.Model?(type.hookup(this[0]),this):this.models.apply(this,arguments)[0]}}(jQuery),function($){var getArgs=function(args){return args[0]&&$.isArray(args[0])?args[0]:args[0]instanceof $.Model.List?$.makeArray(args[0]):$.makeArray(args)},id=0,getIds=function(item){return item[item.constructor.id]},expando=jQuery.expando,each=$.each,ajax=$.Model._ajax,ajaxMethods={update:function(str){return function(ids,attrs,success,error){return ajax(str,{ids:ids,attrs:attrs},success,error,"-updateAll","put")}},destroy:function(str){return function(ids,success,error){return ajax(str,ids,success,error,"-destroyAll","post")}}};$.Class("jQuery.Model.List",{setup:function(){for(var name in ajaxMethods)"function"!=typeof this[name]&&(this[name]=ajaxMethods[name](this[name]))}},{init:function(instances,noEvents){this.length=0,this._data={},this._namespace=".list"+ ++id,this.push.apply(this,$.makeArray(instances||[]))},slice:function(){return new this.Class(Array.prototype.slice.apply(this,arguments))},match:function(property,value){return this.grep(function(inst){return inst[property]==value})},grep:function(callback,args){return new this.Class($.grep(this,callback,args))},_makeData:function(){var data=this._data={};this.each(function(i,inst){data[inst[inst.constructor.id]]=inst})},get:function(){if(!this.length)return new this.Class([]);this._changed&&this._makeData();for(var matches,val,list=[],constructor=this[0].constructor,underscored=constructor._fullName,idName=constructor.id,test=new RegExp(underscored+"_([^ ]+)"),args=getArgs(arguments),i=0;i<args.length;i++)(val=args[i].nodeName&&(matches=args[i].className.match(test))?this._data[matches[1]]:this._data["string"==typeof args[i]||"number"==typeof args[i]?args[i]:args[i][idName]])&&list.push(val);return new this.Class(list)},remove:function(args){if(!this.length)return[];var matches,list=[],constructor=this[0].constructor,underscored=constructor._fullName,idName=constructor.id,test=new RegExp(underscored+"_([^ ]+)");args=getArgs(arguments);for(var i=0;i<this.length;){for(var inst=this[i],found=!1,a=0;a<args.length;a++){var id=args[a].nodeName&&(matches=args[a].className.match(test))&&matches[1]||("string"==typeof args[a]||"number"==typeof args[a]?args[a]:args[a][idName]);if(inst[idName]==id){list.push.apply(list,this.splice(i,1)),args.splice(a,1),found=!0;break}}found||i++}var ret=new this.Class(list);return ret.length&&$([this]).trigger("remove",[ret]),ret},elements:function(context){return $(this.map(function(item){return"."+item.identity()}).join(","),context)},model:function(){return this.constructor.namespace},findAll:function(params,success,error){var self=this;this.model().findAll(params,function(items){self.push(items),success&&success(self)},error)},destroy:function(success,error){var ids=this.map(getIds),items=this.slice(0,this.length);return ids.length?this.constructor.destroy(ids,function(){each(items,function(){this.destroyed()}),success&&success(items)},error):success&&success(this),this},update:function(attrs,success,error){var ids=this.map(getIds),items=this.slice(0,this.length);return ids.length?this.constructor.update(ids,attrs,function(newAttrs){var attributes=$.extend(attrs,newAttrs||{});each(items,function(){this.updated(attributes)}),success&&success(items)},error):success&&success(this),this},bind:function(){return void 0===this[expando]&&this.bindings(this),$.fn.bind.apply($([this]),arguments),this},unbind:function(){return $.fn.unbind.apply($([this]),arguments),void 0===this[expando]&&$(this).unbind(this._namespace),this},bindings:function(items){var self=this;$(items).bind("destroyed"+this._namespace,function(){self.remove(this)}).bind("updated"+this._namespace,function(){$([self]).trigger("updated",this)})},push:function(){var args=getArgs(arguments);void 0!==this[expando]&&this.bindings(args),this._changed=!0;var res=push.apply(this,args);return this[expando]&&args.length&&$([this]).trigger("add",[args]),res},serialize:function(){return this.map(function(item){return item.serialize()})}});var push=[].push;each({pop:[].pop,shift:[].shift,unshift:[].unshift,splice:[].splice,sort:[].sort},function(name,func){$.Model.List.prototype[name]=function(){return this._changed=!0,func.apply(this,arguments)}}),each(["each","map"],function(i,name){$.Model.List.prototype[name]=function(callback,args){return $[name](this,callback,args)}})}(jQuery),function($){var getSetZero=function(v){return void 0!==v?this.array[0]=v:this.array[0]},getSetOne=function(v){return void 0!==v?this.array[1]=v:this.array[1]};$.Vector=function(){this.update($.makeArray(arguments))},$.Vector.prototype={app:function(f){var i,newArr=[];for(i=0;i<this.array.length;i++)newArr.push(f(this.array[i]));return(new $.Vector).update(newArr)},plus:function(){var i,args=arguments[0]instanceof $.Vector?arguments[0].array:$.makeArray(arguments),arr=this.array.slice(0),vec=new $.Vector;for(i=0;i<args.length;i++)arr[i]=(arr[i]?arr[i]:0)+args[i];return vec.update(arr)},minus:function(){var i,args=arguments[0]instanceof $.Vector?arguments[0].array:$.makeArray(arguments),arr=this.array.slice(0),vec=new $.Vector;for(i=0;i<args.length;i++)arr[i]=(arr[i]?arr[i]:0)-args[i];return vec.update(arr)},equals:function(){var i,args=arguments[0]instanceof $.Vector?arguments[0].array:$.makeArray(arguments),arr=this.array.slice(0),vec=new $.Vector;for(i=0;i<args.length;i++)if(arr[i]!=args[i])return null;return vec.update(arr)},x:getSetZero,width:getSetZero,y:getSetOne,height:getSetOne,top:getSetOne,left:getSetZero,toString:function(){return"("+this.array[0]+","+this.array[1]+")"},update:function(array){var i;if(this.array)for(i=0;i<this.array.length;i++)delete this.array[i];for(this.array=array,i=0;i<array.length;i++)this[i]=this.array[i];return this}},$.Event.prototype.vector=function(){if(this.originalEvent.synthetic){var doc=document.documentElement,body=document.body;return new $.Vector(this.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc.clientLeft||0),this.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc.clientTop||0))}return new $.Vector(this.pageX,this.pageY)},$.fn.offsetv=function(){if(this[0]==window)return new $.Vector(window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop);var offset=this.offset();return new $.Vector(offset.left,offset.top)},$.fn.dimensionsv=function(which){return this[0]!=window&&which?new $.Vector(this[which+"Width"](),this[which+"Height"]()):new $.Vector(this.width(),this.height())}}(jQuery),function($){var bind=function(object,method){var args=Array.prototype.slice.call(arguments,2);return function(){var args2=[this].concat(args,$.makeArray(arguments));return method.apply(object,args2)}},event=$.event,clearSelection=window.getSelection?function(){window.getSelection().removeAllRanges()}:function(){};$.Drag=function(){},$.extend($.Drag,{lowerName:"drag",current:null,distance:0,mousedown:function(ev,element){if((0===ev.button||1==ev.button)&&!this.current){var drag=new $.Drag,delegate=ev.liveFired||element,selector=ev.handleObj.selector,self=this;this.current=drag,drag.setup({element:element,delegate:ev.liveFired||element,selector:ev.handleObj.selector,moved:!1,_distance:this.distance,callbacks:{dragdown:event.find(delegate,["dragdown"],selector),draginit:event.find(delegate,["draginit"],selector),dragover:event.find(delegate,["dragover"],selector),dragmove:event.find(delegate,["dragmove"],selector),dragout:event.find(delegate,["dragout"],selector),dragend:event.find(delegate,["dragend"],selector)},destroyed:function(){self.current=null}},ev)}}}),$.extend($.Drag.prototype,{setup:function(options,ev){$.extend(this,options);var mousemove=bind(this,this.mousemove),mouseup=bind(this,this.mouseup);this.element=$(this.element),this.event=ev,this.moved=!1,this.allowOtherDrags=!1,this._mousemove=mousemove,this._mouseup=mouseup,this._distance=options.distance?options.distance:0,this.mouseStartPosition=ev.vector(),$(document).bind("mousemove",mousemove),$(document).bind("mouseup",mouseup),this.callEvents("down",this.element,ev)||(this.noSelection(this.delegate),clearSelection())},destroy:function(){$(document).unbind("mousemove",this._mousemove),$(document).unbind("mouseup",this._mouseup),this.moved||(this.event=this.element=null),this.selection(this.delegate),this.destroyed()},mousemove:function(docEl,ev){if(!this.moved){if(Math.sqrt(Math.pow(ev.pageX-this.event.pageX,2)+Math.pow(ev.pageY-this.event.pageY,2))<this._distance)return!1;this.init(this.element,ev),this.moved=!0}var pointer=ev.vector();this._start_position&&this._start_position.equals(pointer)||this.draw(pointer,ev)},mouseup:function(docEl,event){this.moved&&this.end(event),this.destroy()},noSelection:function(elm){elm=elm||this.delegate,document.documentElement.onselectstart=function(){return!1},document.documentElement.unselectable="on",this.selectionDisabled=this.selectionDisabled?this.selectionDisabled.add(elm):$(elm),this.selectionDisabled.css("-moz-user-select","-moz-none")},selection:function(elm){this.selectionDisabled&&(document.documentElement.onselectstart=function(){},document.documentElement.unselectable="off",this.selectionDisabled.css("-moz-user-select",""))},init:function(element,event){element=$(element);var startElement=this.movingElement=this.element=$(element);this._cancelled=!1,this.event=event,this.mouseElementPosition=this.mouseStartPosition.minus(this.element.offsetv()),this.callEvents("init",element,event),!0!==this._cancelled&&(this.startPosition=startElement!=this.movingElement?this.movingElement.offsetv():this.currentDelta(),this.makePositioned(this.movingElement),this.oldZIndex=this.movingElement.css("zIndex"),this.movingElement.css("zIndex",1e3),!this._only&&this.constructor.responder&&this.constructor.responder.compile(event,this))},makePositioned:function(that){var style,pos=that.css("position");pos&&"static"!=pos||(style={position:"relative"},window.opera&&(style.top="0px",style.left="0px"),that.css(style))},callEvents:function(type,element,event,drop){var i,cbs=this.callbacks[this.constructor.lowerName+type];for(i=0;i<cbs.length;i++)cbs[i].call(element,event,this,drop);return cbs.length},currentDelta:function(){return new $.Vector(parseInt(this.movingElement.css("left"),10)||0,parseInt(this.movingElement.css("top"),10)||0)},draw:function(pointer,event){this._cancelled||(clearSelection(),this.location=pointer.minus(this.mouseElementPosition),this.move(event),this._cancelled||(event.isDefaultPrevented()||this.position(this.location),!this._only&&this.constructor.responder&&this.constructor.responder.show(pointer,this,event)))},position:function(newOffsetv){var style,dragged_element_css_offset=this.currentDelta(),dragged_element_position_vector=this.movingElement.offsetv().minus(dragged_element_css_offset);this.required_css_position=newOffsetv.minus(dragged_element_position_vector),this.offsetv=newOffsetv,style=this.movingElement[0].style,this._cancelled||this._horizontal||(style.top=this.required_css_position.top()+"px"),this._cancelled||this._vertical||(style.left=this.required_css_position.left()+"px")},move:function(event){this.callEvents("move",this.element,event)},over:function(event,drop){this.callEvents("over",this.element,event,drop)},out:function(event,drop){this.callEvents("out",this.element,event,drop)},end:function(event){if(!this._cancelled){if(!this._only&&this.constructor.responder&&this.constructor.responder.end(event,this),this.callEvents("end",this.element,event),this._revert){var self=this;this.movingElement.animate({top:this.startPosition.top()+"px",left:this.startPosition.left()+"px"},function(){self.cleanup.apply(self,arguments)})}else this.cleanup();this.event=null}},cleanup:function(){this.movingElement.css({zIndex:this.oldZIndex}),this.movingElement[0]===this.element[0]||this.movingElement.has(this.element[0]).length||this.element.has(this.movingElement[0]).length||this.movingElement.css({display:"none"}),this._removeMovingElement&&this.movingElement.remove(),this.movingElement=this.element=this.event=null},cancel:function(){this._cancelled=!0,!this._only&&this.constructor.responder&&this.constructor.responder.clear(this.event.vector(),this,this.event),this.destroy()},ghost:function(loc){console.log("ghost called...");var ghost=this.movingElement.clone().css("position","absolute");return(loc?$(loc):this.movingElement).after(ghost),ghost.width(this.movingElement.width()).height(this.movingElement.height()),ghost.offset(this.movingElement.offset()),this.movingElement=ghost,this.noSelection(ghost),this._removeMovingElement=!0,ghost},representative:function(element,offsetX,offsetY){this._offsetX=offsetX||0,this._offsetY=offsetY||0;var p=this.mouseStartPosition;this.movingElement=$(element),this.movingElement.css({top:p.y()-this._offsetY+"px",left:p.x()-this._offsetX+"px",display:"block",position:"absolute"}).show(),this.noSelection(this.movingElement),this.mouseElementPosition=new $.Vector(this._offsetX,this._offsetY)},revert:function(val){return this._revert=void 0===val||val,this},vertical:function(){return this._vertical=!0,this},horizontal:function(){return this._horizontal=!0,!0},only:function(only){return this._only=void 0===only||only},distance:function(val){return void 0!==val?(this._distance=val,this):this._distance}}),event.setupHelper(["dragdown","draginit","dragover","dragmove","dragout","dragend"],"mousedown",function(e){$.Drag.mousedown.call($.Drag,e,this)}),$.Drag.prototype.limit=function(container,center){var styles=container.curStyles("borderTopWidth","paddingTop","borderLeftWidth","paddingLeft"),paddingBorder=new $.Vector(parseInt(styles.borderLeftWidth,10)+parseInt(styles.paddingLeft,10)||0,parseInt(styles.borderTopWidth,10)+parseInt(styles.paddingTop,10)||0);return this._limit={offset:container.offsetv().plus(paddingBorder),size:container.dimensionsv(),center:!0===center?"both":center},this};var oldPosition1=$.Drag.prototype.position;$.Drag.prototype.position=function(offsetPositionv){if(this._limit){var limit=this._limit,center=limit.center&&limit.center.toLowerCase(),movingSize=this.movingElement.dimensionsv("outer"),halfHeight=center&&"x"!=center?movingSize.height()/2:0,halfWidth=center&&"y"!=center?movingSize.width()/2:0,lot=limit.offset.top(),lof=limit.offset.left(),height=limit.size.height(),width=limit.size.width();offsetPositionv.top()+halfHeight<lot&&offsetPositionv.top(lot-halfHeight),offsetPositionv.top()+movingSize.height()-halfHeight>lot+height&&offsetPositionv.top(lot+height-movingSize.height()+halfHeight),offsetPositionv.left()+halfWidth<lof&&offsetPositionv.left(lof-halfWidth),offsetPositionv.left()+movingSize.width()-halfWidth>lof+width&&offsetPositionv.left(lof+width-movingSize.left()+halfWidth)}oldPosition1.call(this,offsetPositionv)};var round=function(x,m){return Math.round(x/m)*m};$.Drag.prototype.step=function(amount,container,center){"number"==typeof amount&&(amount={x:amount,y:amount}),container=container||$(document.body),this._step=amount;var styles=container.curStyles("borderTopWidth","paddingTop","borderLeftWidth","paddingLeft"),top=parseInt(styles.borderTopWidth)+parseInt(styles.paddingTop),left=parseInt(styles.borderLeftWidth)+parseInt(styles.paddingLeft);return this._step.offset=container.offsetv().plus(left,top),this._step.center=center,this};var oldPosition2=$.Drag.prototype.position;$.Drag.prototype.position=function(offsetPositionv){if(this._step){var step=this._step,center=step.center&&step.center.toLowerCase(),movingSize=this.movingElement.dimensionsv("outer"),lot=step.offset.top()-(center&&"x"!=center?movingSize.height()/2:0),lof=step.offset.left()-(center&&"y"!=center?movingSize.width()/2:0);this._step.x&&offsetPositionv.left(Math.round(lof+round(offsetPositionv.left()-lof,this._step.x))),this._step.y&&offsetPositionv.top(Math.round(lot+round(offsetPositionv.top()-lot,this._step.y)))}oldPosition2.call(this,offsetPositionv)},$.Drag.prototype.scrolls=function(elements,options){console.log("--drag.proto--");elements=$(elements);for(var i=0;i<elements.length;i++)this.constructor.responder._elements.push(elements.eq(i).data("_dropData",new $.Scrollable(elements[i],options))[0])}}(jQuery),function($){var event=$.event,eventNames=["dropover","dropon","dropout","dropinit","dropmove","dropend"];$.Drop=function(callbacks,element){jQuery.extend(this,callbacks),this.element=$(element)},$.each(eventNames,function(){event.special[this]={add:function(handleObj){var el=$(this),current=el.data("dropEventCount")||0;el.data("dropEventCount",current+1),0==current&&$.Drop.addElement(this)},remove:function(){var el=$(this),current=el.data("dropEventCount")||0;el.data("dropEventCount",current-1),current<=1&&$.Drop.removeElement(this)}}}),$.extend($.Drop,{lowerName:"drop",_rootElements:[],_elements:$(),last_active:[],endName:"dropon",addElement:function(el){for(var i=0;i<this._rootElements.length;i++)if(el==this._rootElements[i])return;this._rootElements.push(el)},removeElement:function(el){for(var i=0;i<this._rootElements.length;i++)if(el==this._rootElements[i])return void this._rootElements.splice(i,1)},sortByDeepestChild:function(a,b){var compare=a.element.compare(b.element);return 16&compare||4&compare?1:8&compare||2&compare?-1:0},isAffected:function(point,moveable,responder){let issame=responder.element!=moveable.element,isone=1==responder.element.within(point[0],point[1],responder._cache).length;return issame&&isone},deactivate:function(responder,mover,event){mover.out(event,responder),responder.callHandlers(this.lowerName+"out",responder.element[0],event,mover)},activate:function(responder,mover,event){mover.over(event,responder),responder.callHandlers(this.lowerName+"over",responder.element[0],event,mover)},move:function(responder,mover,event){responder.callHandlers(this.lowerName+"move",responder.element[0],event,mover)},compile:function(event,drag){if(this.dragging||drag){var el,selector;this.dragging||(this.dragging=drag,this.last_active=[]);for(var newEls=[],dragging=this.dragging,i=0;i<this._rootElements.length;i++){el=this._rootElements[i];var drops=$.event.findBySelector(el,eventNames);for(selector in drops)for(var dropResponders=selector?jQuery(selector,el):[el],e=0;e<dropResponders.length;e++)this.addCallbacks(dropResponders[e],drops[selector],dragging)&&newEls.push(dropResponders[e])}this.add(newEls,event,dragging)}},addCallbacks:function(el,callbacks,onlyNew){var origData=$.data(el,"_dropData");if(!origData)return $.data(el,"_dropData",new $.Drop(callbacks,el)),!0;if(!onlyNew){var origCbs=origData;for(var eventName in callbacks)origCbs[eventName]=origCbs[eventName]?origCbs[eventName].concat(callbacks[eventName]):callbacks[eventName];return!1}},add:function(newEls,event,drag,dragging){for(var drop,i=0;i<newEls.length;)(drop=$.data(newEls[i],"_dropData")).callHandlers(this.lowerName+"init",newEls[i],event,drag),drop._canceled?newEls.splice(i,1):i++;this._elements.push.apply(this._elements,newEls)},show:function(point,moveable,event){moveable.element;if(this._elements.length){for(var j,la,toBeActivated,aff,drag,affected=[],propagate=!0,i=0,oldLastActive=this.last_active;i<this._elements.length;)(drag=$.data(this._elements[i],"_dropData"))?(i++,this.isAffected(point,moveable,drag)&&affected.push(drag)):this._elements.splice(i,1);for(affected.sort(this.sortByDeepestChild),event.stopRespondPropagate=function(){propagate=!1},toBeActivated=affected.slice(),this.last_active=affected,j=0;j<oldLastActive.length;j++){for(la=oldLastActive[j],i=0;aff=toBeActivated[i];){if(la==aff){toBeActivated.splice(i,1);break}i++}if(aff||this.deactivate(la,moveable,event),!propagate)return}for(i=0;i<toBeActivated.length;i++)if(this.activate(toBeActivated[i],moveable,event),!propagate)return;for(i=0;i<affected.length;i++)if(this.move(affected[i],moveable,event),!propagate)return}},end:function(event,moveable){var la,endName=this.lowerName+"end";console.info("end",this.last_active);for(var i=0;i<this.last_active.length;i++)la=this.last_active[i],this.isAffected(event.vector(),moveable,la)&&la[this.endName]&&la.callHandlers(this.endName,null,event,moveable);for(var r=0;r<this._elements.length;r++)$.data(this._elements[r],"_dropData").callHandlers(endName,null,event,moveable);this.clear()},clear:function(){this._elements.each(function(){$.removeData(this,"_dropData")}),this._elements=$(),delete this.dragging}}),$.Drag.responder=$.Drop,$.extend($.Drop.prototype,{callHandlers:function(method,el,ev,drag){for(var length=this[method]?this[method].length:0,i=0;i<length;i++)this[method][i].call(el||this.element[0],ev,this,drag)},cache:function(value){this._cache=null==value||value},cancel:function(){this._canceled=!0}})}(jQuery),function($){$.Scrollable=function(element,options){this.element=jQuery(element),this.options=$.extend({distance:30,delta:function(diff,distance){return(distance-diff)/2},direction:"xy"},options),this.x=-1!=this.options.direction.indexOf("x"),this.y=-1!=this.options.direction.indexOf("y")},$.extend($.Scrollable.prototype,{init:function(element){this.element=jQuery(element)},callHandlers:function(method,el,ev,drag){console.log("--callhandlers--"),this[method](el||this.element[0],ev,this,drag)},dropover:function(){},dropon:function(){console.log("--dropon--"),this.clear_timeout()},dropout:function(){this.clear_timeout()},dropinit:function(){console.log("--dropinit--")},dropend:function(){},clear_timeout:function(){this.interval&&(clearTimeout(this.interval),this.interval=null)},distance:function(diff){return(30-diff)/2},dropmove:function(el,ev,drop,drag){console.log("callHandlers"),this.clear_timeout();var mouse=ev.vector(),location_object=$(el==document.documentElement?window:el),dimensions=location_object.dimensionsv("outer"),position=location_object.offsetv(),bottom=position.y()+dimensions.y()-mouse.y(),top=mouse.y()-position.y(),right=position.x()+dimensions.x()-mouse.x(),left=mouse.x()-position.x(),dx=0,dy=0,distance=this.options.distance;if(bottom<distance&&this.y?dy=this.options.delta(bottom,distance):top<distance&&this.y&&(dy=-this.options.delta(top,distance)),right<distance&&this.options&&this.x?dx=this.options.delta(right,distance):left<distance&&this.x&&(dx=-this.options.delta(left,distance)),dx||dy){var self=this;this.interval=setTimeout(function(){self.move($(el),drag.movingElement,dx,dy,ev,ev.clientX,ev.clientY,ev.screenX,ev.screenY)},15)}},move:function(scroll_element,drag_element,dx,dy,ev){scroll_element.scrollTop(scroll_element.scrollTop()+dy),scroll_element.scrollLeft(scroll_element.scrollLeft()+dx),drag_element.trigger($.event.fix({type:"mousemove",clientX:ev.clientX,clientY:ev.clientY,screenX:ev.screenX,screenY:ev.screenY,pageX:ev.pageX,pageY:ev.pageY}))}})}(jQuery),function($){$.Hover=function(){this._delay=$.Hover.delay,this._distance=$.Hover.distance,this._leave=$.Hover.leave},$.extend($.Hover,{delay:100,distance:10,leave:0}),$.extend($.Hover.prototype,{delay:function(delay){return this._delay=delay,this},distance:function(distance){return this._distance=distance,this},leave:function(leave){return this._leave=leave,this}});var event=$.event;event.dispatch;event.setupHelper(["hoverinit","hoverenter","hoverleave","hovermove"],"mouseenter",function(ev){var delegate=ev.liveFired||ev.currentTarget,selector=ev.handleObj.selector;if(!$.data(delegate,"_hover"+selector)){$.data(delegate,"_hover"+selector,!0);var timer,leaveTimer,loc={pageX:ev.pageX,pageY:ev.pageY},dist=0,enteredEl=this,hovered=!1,lastEv=ev,hover=new $.Hover,callHoverLeave=function(){$.each(event.find(delegate,["hoverleave"],selector),function(){this.call(enteredEl,ev,hover)}),cleanUp()},mouseenter=function(ev){clearTimeout(leaveTimer),dist+=Math.pow(ev.pageX-loc.pageX,2)+Math.pow(ev.pageY-loc.pageY,2),loc={pageX:ev.pageX,pageY:ev.pageY},lastEv=ev},mouseleave=function(ev){clearTimeout(timer),hovered?0===hover._leave?callHoverLeave():(clearTimeout(leaveTimer),leaveTimer=setTimeout(function(){callHoverLeave()},hover._leave)):cleanUp()},cleanUp=function(){$(enteredEl).unbind("mouseleave",mouseleave),$(enteredEl).unbind("mousemove",mouseenter),$.removeData(delegate,"_hover"+selector)};$(enteredEl).bind("mousemove",mouseenter).bind("mouseleave",mouseleave),$.each(event.find(delegate,["hoverinit"],selector),function(){this.call(enteredEl,ev,hover)}),timer=setTimeout(function(){if(dist<hover._distance&&0==$(enteredEl).queue().length)return $.each(event.find(delegate,["hoverenter"],selector),function(){this.call(enteredEl,lastEv,hover)}),void(hovered=!0);dist=0,timer=setTimeout(arguments.callee,hover._delay)},hover._delay)}})}(jQuery),function($){var myEval=function(script){eval(script)},chop=function(string){return string.substr(0,string.length-1)},rSplit=$.String.rsplit,extend=$.extend,isArray=$.isArray,clean=function(content){return content.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/\t/g,"\\t")},escapeHTML=function(content){return content.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")},EJS=function(options){if(this.constructor!=EJS){var ejs=new EJS(options);return function(data,helpers){return ejs.render(data,helpers)}}if("function"==typeof options)return this.template={},void(this.template.process=options);extend(this,EJS.options,options),this.template=compile(this.text,this.type,this.name)};$.EJS=EJS,EJS.prototype={constructor:EJS,render:function(object,extraHelpers){object=object||{},this._extra_helpers=extraHelpers;var v=new EJS.Helpers(object,extraHelpers||{});return this.template.process.call(object,object,v)}},EJS.text=function(input){if("string"==typeof input)return input;if(null===input||void 0===input)return"";var hook=input.hookup&&function(el,id){input.hookup.call(input,el,id)}||"function"==typeof input&&input||isArray(input)&&function(el,id){for(var i=0;i<input.length;i++){input[i].hookup?input[i].hookup(el,id):input[i](el,id)}};return hook?"data-view-id='"+$.View.hookup(hook)+"'":input.toString?input.toString():""},EJS.clean=function(text){return"string"==typeof text?escapeHTML(text):"number"==typeof text?text:EJS.text(text)};var scan=function(scanner,source,block){for(var source_split=rSplit(source,/\n/),i=0;i<source_split.length;i++)scanline(scanner,source_split[i],block)},scanline=function(scanner,line,block){scanner.lines++;for(var token,line_split=rSplit(line,scanner.splitter),i=0;i<line_split.length;i++)null!==(token=line_split[i])&&block(token,scanner)},makeScanner=function(left,right){var scanner={};return extend(scanner,{left:left+"%",right:"%"+right,dLeft:left+"%%",dRight:"%%"+right,eeLeft:left+"%==",eLeft:left+"%=",cmnt:left+"%#",scan:scan,lines:0}),scanner.splitter=new RegExp("("+[scanner.dLeft,scanner.dRight,scanner.eeLeft,scanner.eLeft,scanner.cmnt,scanner.left,scanner.right+"\n",scanner.right,"\n"].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")"),scanner},compile=function(source,left,name){source=source.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),left=left||"<";var buff=new EJS.Buffer(["var ___v1ew = [];"],[]),content="",put=function(content){buff.push("___v1ew.push(",'"',clean(content),'");')},startTag=null,empty=function(){content=""};scan(makeScanner(left,"["===left?"]":">"),source||"",function(token,scanner){if(null===startTag)switch(token){case"\n":put(content+="\n"),buff.cr(),empty();break;case scanner.left:case scanner.eLeft:case scanner.eeLeft:case scanner.cmnt:startTag=token,content.length>0&&put(content),empty();break;case scanner.dLeft:content+=scanner.left;break;default:content+=token}else switch(token){case scanner.right:switch(startTag){case scanner.left:"\n"==content[content.length-1]?(content=chop(content),buff.push(content,";"),buff.cr()):buff.push(content,";");break;case scanner.eLeft:buff.push("___v1ew.push(","(jQuery.EJS.clean(",content,")));");break;case scanner.eeLeft:buff.push("___v1ew.push(","(jQuery.EJS.text(",content,")));")}startTag=null,empty();break;case scanner.dRight:content+=scanner.right;break;default:content+=token}}),content.length>0&&buff.push("___v1ew.push(",'"',clean(content)+'");');var out={out:"try { with(_VIEW) { with (_CONTEXT) {"+buff.close()+" return ___v1ew.join('');}}}catch(e){e.lineNumber=null;throw e;}"};return myEval.call(out,"this.process = (function(_CONTEXT,_VIEW){"+out.out+"});\r\n//# sourceURL="+name+".js"),out};EJS.Buffer=function(pre_cmd,post){this.line=[],this.script=[],this.post=post,this.push.apply(this,pre_cmd)},EJS.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n"),this.line=[]},close:function(){return this.line.length>0&&(this.script.push(this.line.join("")),this.line=[]),this.post.length&&this.push.apply(this,this.post),this.script.push(";"),this.script.join("")}},EJS.options={type:"<",ext:".ejs"},EJS.Helpers=function(data,extras){this._data=data,this._extras=extras,extend(this,extras)},EJS.Helpers.prototype={plugin:function(name){var args=$.makeArray(arguments),widget=args.shift();return function(el){var jq=$(el);jq[widget].apply(jq,args)}},view:function(url,data,helpers){return helpers=helpers||this._extras,data=data||this._data,$.View(url,data,helpers)}},$.View.register({suffix:"ejs",script:function(id,src){return"jQuery.EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:src,name:id}).template.out+" })"},renderer:function(id,text){var ejs=new EJS({text:text,name:id});return function(data,helpers){return ejs.render.call(ejs,data,helpers)}}})}(jQuery),function(b,f){b.fn.jPlayer=function(a){var c="string"==typeof a,d=Array.prototype.slice.call(arguments,1),e=this;a=!c&&d.length?b.extend.apply(null,[!0,a].concat(d)):a;return c&&"_"===a.charAt(0)?e:(c?this.each(function(){var c=b.data(this,"jPlayer"),h=c&&b.isFunction(c[a])?c[a].apply(c,d):c;if(h!==c&&h!==f)return e=h,!1}):this.each(function(){var c=b.data(this,"jPlayer");c?c.option(a||{}):b.data(this,"jPlayer",new b.jPlayer(a,this))}),e)},b.jPlayer=function(a,c){if(arguments.length){this.element=b(c),this.options=b.extend(!0,{},this.options,a);var d=this;this.element.bind("remove.jPlayer",function(){d.destroy()}),this._init()}},b.jPlayer.emulateMethods="load play pause",b.jPlayer.emulateStatus="src readyState networkState currentTime duration paused ended playbackRate",b.jPlayer.emulateOptions="muted volume",b.jPlayer.reservedEvent="ready flashreset resize repeat error warning",b.jPlayer.event={ready:"jPlayer_ready",flashreset:"jPlayer_flashreset",resize:"jPlayer_resize",repeat:"jPlayer_repeat",click:"jPlayer_click",error:"jPlayer_error",warning:"jPlayer_warning",loadstart:"jPlayer_loadstart",progress:"jPlayer_progress",suspend:"jPlayer_suspend",abort:"jPlayer_abort",emptied:"jPlayer_emptied",stalled:"jPlayer_stalled",play:"jPlayer_play",pause:"jPlayer_pause",loadedmetadata:"jPlayer_loadedmetadata",loadeddata:"jPlayer_loadeddata",waiting:"jPlayer_waiting",playing:"jPlayer_playing",canplay:"jPlayer_canplay",canplaythrough:"jPlayer_canplaythrough",seeking:"jPlayer_seeking",seeked:"jPlayer_seeked",timeupdate:"jPlayer_timeupdate",ended:"jPlayer_ended",ratechange:"jPlayer_ratechange",durationchange:"jPlayer_durationchange",volumechange:"jPlayer_volumechange"},b.jPlayer.htmlEvent="loadstart,abort,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,ratechange".split(","),b.jPlayer.pause=function(){b.each(b.jPlayer.prototype.instances,function(a,b){b.data("jPlayer").status.srcSet&&b.jPlayer("pause")})},b.jPlayer.timeFormat={showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""},b.jPlayer.convertTime=function(a){var d=(c=new Date(1e3*a)).getUTCHours(),c=(a=c.getUTCMinutes(),c.getUTCSeconds());d=b.jPlayer.timeFormat.padHour&&d<10?"0"+d:d,a=b.jPlayer.timeFormat.padMin&&a<10?"0"+a:a,c=b.jPlayer.timeFormat.padSec&&c<10?"0"+c:c;return(b.jPlayer.timeFormat.showHour?d+b.jPlayer.timeFormat.sepHour:"")+(b.jPlayer.timeFormat.showMin?a+b.jPlayer.timeFormat.sepMin:"")+(b.jPlayer.timeFormat.showSec?c+b.jPlayer.timeFormat.sepSec:"")},b.jPlayer.uaBrowser=function(a){a=a.toLowerCase();return{browser:(a=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[])[1]||"",version:a[2]||"0"}},b.jPlayer.uaPlatform=function(a){var b=a.toLowerCase();a=/(ipad|iphone|ipod|android|blackberry|playbook|windows ce|webos)/.exec(b)||[],b=/(ipad|playbook)/.exec(b)||!/(mobile)/.exec(b)&&/(android)/.exec(b)||[];return a[1]&&(a[1]=a[1].replace(/\s/g,"_")),{platform:a[1]||"",tablet:b[1]||""}},b.jPlayer.browser={},b.jPlayer.platform={};var i=b.jPlayer.uaBrowser(navigator.userAgent);i.browser&&(b.jPlayer.browser[i.browser]=!0,b.jPlayer.browser.version=i.version),(i=b.jPlayer.uaPlatform(navigator.userAgent)).platform&&(b.jPlayer.platform[i.platform]=!0,b.jPlayer.platform.mobile=!i.tablet,b.jPlayer.platform.tablet=!!i.tablet),b.jPlayer.prototype={count:0,version:{script:"2.1.0",needFlash:"2.1.0",flash:"unknown"},options:{swfPath:"js",solution:"html, flash",supplied:"mp3",preload:"metadata",volume:.8,muted:!1,wmode:"opaque",backgroundColor:"#000000",cssSelectorAncestor:"#jp_container_1",cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",mute:".jp-mute",unmute:".jp-unmute",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",currentTime:".jp-current-time",duration:".jp-duration",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",repeat:".jp-repeat",repeatOff:".jp-repeat-off",gui:".jp-gui",noSolution:".jp-no-solution"},fullScreen:!1,autohide:{restored:!1,full:!0,fadeIn:200,fadeOut:600,hold:1e3},loop:!1,repeat:function(a){a.jPlayer.options.loop?b(this).unbind(".jPlayerRepeat").bind(b.jPlayer.event.ended+".jPlayer.jPlayerRepeat",function(){b(this).jPlayer("play")}):b(this).unbind(".jPlayerRepeat")},nativeVideoControls:{},noFullScreen:{msie:/msie [0-6]/,ipad:/ipad.*?os [0-4]/,iphone:/iphone/,ipod:/ipod/,android_pad:/android [0-3](?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/},noVolume:{ipad:/ipad/,iphone:/iphone/,ipod:/ipod/,android_pad:/android(?!.*?mobile)/,android_phone:/android.*?mobile/,blackberry:/blackberry/,windows_ce:/windows ce/,webos:/webos/,playbook:/playbook/},verticalVolume:!1,idPrefix:"jp",noConflict:"jQuery",emulateHtml:!1,errorAlerts:!1,warningAlerts:!1},optionsAudio:{size:{width:"0px",height:"0px",cssClass:""},sizeFull:{width:"0px",height:"0px",cssClass:""}},optionsVideo:{size:{width:"480px",height:"270px",cssClass:"jp-video-270p"},sizeFull:{width:"100%",height:"100%",cssClass:"jp-video-full"}},instances:{},status:{src:"",media:{},paused:!0,format:{},formatType:"",waitForPlay:!0,waitForLoad:!0,srcSet:!1,video:!1,seekPercent:0,currentPercentRelative:0,currentPercentAbsolute:0,currentTime:0,duration:0,readyState:0,networkState:0,playbackRate:1,ended:0},internal:{ready:!1},solution:{html:!0,flash:!0},format:{mp3:{codec:'audio/mpeg; codecs="mp3"',flashCanPlay:!0,media:"audio"},m4a:{codec:'audio/mp4; codecs="mp4a.40.2"',flashCanPlay:!0,media:"audio"},oga:{codec:'audio/ogg; codecs="vorbis"',flashCanPlay:!1,media:"audio"},wav:{codec:'audio/wav; codecs="1"',flashCanPlay:!1,media:"audio"},webma:{codec:'audio/webm; codecs="vorbis"',flashCanPlay:!1,media:"audio"},fla:{codec:"audio/x-flv",flashCanPlay:!0,media:"audio"},m4v:{codec:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',flashCanPlay:!0,media:"video"},ogv:{codec:'video/ogg; codecs="theora, vorbis"',flashCanPlay:!1,media:"video"},webmv:{codec:'video/webm; codecs="vorbis, vp8"',flashCanPlay:!1,media:"video"},flv:{codec:"video/x-flv",flashCanPlay:!0,media:"video"}},_init:function(){var a=this;if(this.element.empty(),this.status=b.extend({},this.status),this.internal=b.extend({},this.internal),this.internal.domNode=this.element.get(0),this.formats=[],this.solutions=[],this.require={},this.htmlElement={},this.html={},this.html.audio={},this.html.video={},this.flash={},this.css={},this.css.cs={},this.css.jq={},this.ancestorJq=[],this.options.volume=this._limitValue(this.options.volume,0,1),b.each(this.options.supplied.toLowerCase().split(","),function(c,d){var e=d.replace(/^\s+|\s+$/g,"");if(a.format[e]){var f=!1;b.each(a.formats,function(a,b){if(e===b)return f=!0,!1}),f||a.formats.push(e)}}),b.each(this.options.solution.toLowerCase().split(","),function(c,d){var e=d.replace(/^\s+|\s+$/g,"");if(a.solution[e]){var f=!1;b.each(a.solutions,function(a,b){if(e===b)return f=!0,!1}),f||a.solutions.push(e)}}),this.internal.instance="jp_"+this.count,this.instances[this.internal.instance]=this.element,this.element.attr("id")||this.element.attr("id",this.options.idPrefix+"_jplayer_"+this.count),this.internal.self=b.extend({},{id:this.element.attr("id"),jq:this.element}),this.internal.audio=b.extend({},{id:this.options.idPrefix+"_audio_"+this.count,jq:f}),this.internal.video=b.extend({},{id:this.options.idPrefix+"_video_"+this.count,jq:f}),this.internal.flash=b.extend({},{id:this.options.idPrefix+"_flash_"+this.count,jq:f,swf:this.options.swfPath+(".swf"!==this.options.swfPath.toLowerCase().slice(-4)?(this.options.swfPath&&"/"!==this.options.swfPath.slice(-1)?"/":"")+"Jplayer.swf":"")}),this.internal.poster=b.extend({},{id:this.options.idPrefix+"_poster_"+this.count,jq:f}),b.each(b.jPlayer.event,function(b,c){a.options[b]!==f&&(a.element.bind(c+".jPlayer",a.options[b]),a.options[b]=f)}),this.require.audio=!1,this.require.video=!1,b.each(this.formats,function(b,c){a.require[a.format[c].media]=!0}),this.options=this.require.video?b.extend(!0,{},this.optionsVideo,this.options):b.extend(!0,{},this.optionsAudio,this.options),this._setSize(),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._restrictNativeVideoControls(),this.htmlElement.poster=document.createElement("img"),this.htmlElement.poster.id=this.internal.poster.id,this.htmlElement.poster.onload=function(){(!a.status.video||a.status.waitForPlay)&&a.internal.poster.jq.show()},this.element.append(this.htmlElement.poster),this.internal.poster.jq=b("#"+this.internal.poster.id),this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),this.internal.poster.jq.hide(),this.internal.poster.jq.bind("click.jPlayer",function(){a._trigger(b.jPlayer.event.click)}),this.html.audio.available=!1,this.require.audio&&(this.htmlElement.audio=document.createElement("audio"),this.htmlElement.audio.id=this.internal.audio.id,this.html.audio.available=!!this.htmlElement.audio.canPlayType&&this._testCanPlayType(this.htmlElement.audio)),this.html.video.available=!1,this.require.video&&(this.htmlElement.video=document.createElement("video"),this.htmlElement.video.id=this.internal.video.id,this.html.video.available=!!this.htmlElement.video.canPlayType&&this._testCanPlayType(this.htmlElement.video)),this.flash.available=this._checkForFlash(10),this.html.canPlay={},this.flash.canPlay={},b.each(this.formats,function(b,c){a.html.canPlay[c]=a.html[a.format[c].media].available&&""!==a.htmlElement[a.format[c].media].canPlayType(a.format[c].codec),a.flash.canPlay[c]=a.format[c].flashCanPlay&&a.flash.available}),this.html.desired=!1,this.flash.desired=!1,b.each(this.solutions,function(c,d){if(0===c)a[d].desired=!0;else{var e=!1,f=!1;b.each(a.formats,function(b,c){a[a.solutions[0]].canPlay[c]&&("video"===a.format[c].media?f=!0:e=!0)}),a[d].desired=a.require.audio&&!e||a.require.video&&!f}}),this.html.support={},this.flash.support={},b.each(this.formats,function(b,c){a.html.support[c]=a.html.canPlay[c]&&a.html.desired,a.flash.support[c]=a.flash.canPlay[c]&&a.flash.desired}),this.html.used=!1,this.flash.used=!1,b.each(this.solutions,function(c,d){b.each(a.formats,function(b,c){if(a[d].support[c])return a[d].used=!0,!1})}),this._resetActive(),this._resetGate(),this._cssSelectorAncestor(this.options.cssSelectorAncestor),this.html.used||this.flash.used?this.css.jq.noSolution.length&&this.css.jq.noSolution.hide():(this._error({type:b.jPlayer.error.NO_SOLUTION,context:"{solution:'"+this.options.solution+"', supplied:'"+this.options.supplied+"'}",message:b.jPlayer.errorMsg.NO_SOLUTION,hint:b.jPlayer.errorHint.NO_SOLUTION}),this.css.jq.noSolution.length&&this.css.jq.noSolution.show()),this.flash.used){var c,d="jQuery="+encodeURI(this.options.noConflict)+"&id="+encodeURI(this.internal.self.id)+"&vol="+this.options.volume+"&muted="+this.options.muted;if(b.browser.msie&&Number(b.browser.version)<=8){d=['<param name="movie" value="'+this.internal.flash.swf+'" />','<param name="FlashVars" value="'+d+'" />','<param name="allowScriptAccess" value="always" />','<param name="bgcolor" value="'+this.options.backgroundColor+'" />','<param name="wmode" value="'+this.options.wmode+'" />'],c=document.createElement('<object id="'+this.internal.flash.id+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="0" height="0"></object>');for(var e=0;e<d.length;e++)c.appendChild(document.createElement(d[e]))}else e=function(a,b,c){var d=document.createElement("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)},(c=document.createElement("object")).setAttribute("id",this.internal.flash.id),c.setAttribute("data",this.internal.flash.swf),c.setAttribute("type","application/x-shockwave-flash"),c.setAttribute("width","1"),c.setAttribute("height","1"),e(c,"flashvars",d),e(c,"allowscriptaccess","always"),e(c,"bgcolor",this.options.backgroundColor),e(c,"wmode",this.options.wmode);this.element.append(c),this.internal.flash.jq=b(c)}this.html.used&&(this.html.audio.available&&(this._addHtmlEventListeners(this.htmlElement.audio,this.html.audio),this.element.append(this.htmlElement.audio),this.internal.audio.jq=b("#"+this.internal.audio.id)),this.html.video.available&&(this._addHtmlEventListeners(this.htmlElement.video,this.html.video),this.element.append(this.htmlElement.video),this.internal.video.jq=b("#"+this.internal.video.id),this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):this.internal.video.jq.css({width:"0px",height:"0px"}),this.internal.video.jq.bind("click.jPlayer",function(){a._trigger(b.jPlayer.event.click)}))),this.options.emulateHtml&&this._emulateHtmlBridge(),this.html.used&&!this.flash.used&&setTimeout(function(){a.internal.ready=!0,a.version.flash="n/a",a._trigger(b.jPlayer.event.repeat),a._trigger(b.jPlayer.event.ready)},100),this._updateNativeVideoControls(),this._updateInterface(),this._updateButtons(!1),this._updateAutohide(),this._updateVolume(this.options.volume),this._updateMute(this.options.muted),this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),b.jPlayer.prototype.count++},destroy:function(){this.clearMedia(),this._removeUiClass(),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(""),this.css.jq.duration.length&&this.css.jq.duration.text(""),b.each(this.css.jq,function(a,b){b.length&&b.unbind(".jPlayer")}),this.internal.poster.jq.unbind(".jPlayer"),this.internal.video.jq&&this.internal.video.jq.unbind(".jPlayer"),this.options.emulateHtml&&this._destroyHtmlBridge(),this.element.removeData("jPlayer"),this.element.unbind(".jPlayer"),this.element.empty(),delete this.instances[this.internal.instance]},enable:function(){},disable:function(){},_testCanPlayType:function(a){try{return a.canPlayType(this.format.mp3.codec),!0}catch(b){return!1}},_uaBlocklist:function(a){var c=navigator.userAgent.toLowerCase(),d=!1;return b.each(a,function(a,b){if(b&&b.test(c))return d=!0,!1}),d},_restrictNativeVideoControls:function(){this.require.audio&&this.status.nativeVideoControls&&(this.status.nativeVideoControls=!1,this.status.noFullScreen=!0)},_updateNativeVideoControls:function(){this.html.video.available&&this.html.used&&(this.htmlElement.video.controls=this.status.nativeVideoControls,this._updateAutohide(),this.status.nativeVideoControls&&this.require.video?(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})):this.status.waitForPlay&&this.status.video&&(this.internal.poster.jq.show(),this.internal.video.jq.css({width:"0px",height:"0px"})))},_addHtmlEventListeners:function(a,c){var d=this;a.preload=this.options.preload,a.muted=this.options.muted,a.volume=this.options.volume,a.addEventListener("progress",function(){c.gate&&(d._getHtmlStatus(a),d._updateInterface(),d._trigger(b.jPlayer.event.progress))},!1),a.addEventListener("timeupdate",function(){c.gate&&(d._getHtmlStatus(a),d._updateInterface(),d._trigger(b.jPlayer.event.timeupdate))},!1),a.addEventListener("durationchange",function(){c.gate&&(d.status.duration=this.duration,d._getHtmlStatus(a),d._updateInterface(),d._trigger(b.jPlayer.event.durationchange))},!1),a.addEventListener("play",function(){c.gate&&(d._updateButtons(!0),d._html_checkWaitForPlay(),d._trigger(b.jPlayer.event.play))},!1),a.addEventListener("playing",function(){c.gate&&(d._updateButtons(!0),d._seeked(),d._trigger(b.jPlayer.event.playing))},!1),a.addEventListener("pause",function(){c.gate&&(d._updateButtons(!1),d._trigger(b.jPlayer.event.pause))},!1),a.addEventListener("waiting",function(){c.gate&&(d._seeking(),d._trigger(b.jPlayer.event.waiting))},!1),a.addEventListener("seeking",function(){c.gate&&(d._seeking(),d._trigger(b.jPlayer.event.seeking))},!1),a.addEventListener("seeked",function(){c.gate&&(d._seeked(),d._trigger(b.jPlayer.event.seeked))},!1),a.addEventListener("volumechange",function(){c.gate&&(d.options.volume=a.volume,d.options.muted=a.muted,d._updateMute(),d._updateVolume(),d._trigger(b.jPlayer.event.volumechange))},!1),a.addEventListener("suspend",function(){c.gate&&(d._seeked(),d._trigger(b.jPlayer.event.suspend))},!1),a.addEventListener("ended",function(){c.gate&&(d.htmlElement.media.pause(),d._updateButtons(!1),d._getHtmlStatus(a,!1),d._updateInterface(),d._trigger(b.jPlayer.event.ended))},!1),a.addEventListener("error",function(){c.gate&&(d._updateButtons(!1),d._seeked(),d.status.srcSet)&&(clearTimeout(d.internal.htmlDlyCmdId),d.status.waitForLoad=!0,d.status.waitForPlay=!0,d.status.video&&!d.status.nativeVideoControls&&d.internal.video.jq.css({width:"0px",height:"0px"}),d._validString(d.status.media.poster)&&!d.status.nativeVideoControls&&d.internal.poster.jq.show(),d.css.jq.videoPlay.length&&d.css.jq.videoPlay.show(),d._error({type:b.jPlayer.error.URL,context:d.status.src,message:b.jPlayer.errorMsg.URL,hint:b.jPlayer.errorHint.URL}))},!1),b.each(b.jPlayer.htmlEvent,function(e,g){a.addEventListener(this,function(){c.gate&&d._trigger(b.jPlayer.event[g])},!1)})},_getHtmlStatus:function(a,b){var d=0,e=0,g=0,f=0;a.duration&&(this.status.duration=a.duration),d=a.currentTime,e=this.status.duration>0?100*d/this.status.duration:0,"object"==typeof a.seekable&&a.seekable.length>0?(g=this.status.duration>0?100*a.seekable.end(a.seekable.length-1)/this.status.duration:100,f=100*a.currentTime/a.seekable.end(a.seekable.length-1)):(g=100,f=e),b&&(e=f=d=0),this.status.seekPercent=g,this.status.currentPercentRelative=f,this.status.currentPercentAbsolute=e,this.status.currentTime=d,this.status.readyState=a.readyState,this.status.networkState=a.networkState,this.status.playbackRate=a.playbackRate,this.status.ended=a.ended},_resetStatus:function(){this.status=b.extend({},this.status,b.jPlayer.prototype.status)},_trigger:function(a,c,d){(a=b.Event(a)).jPlayer={},a.jPlayer.version=b.extend({},this.version),a.jPlayer.options=b.extend(!0,{},this.options),a.jPlayer.status=b.extend(!0,{},this.status),a.jPlayer.html=b.extend(!0,{},this.html),a.jPlayer.flash=b.extend(!0,{},this.flash),c&&(a.jPlayer.error=b.extend({},c)),d&&(a.jPlayer.warning=b.extend({},d)),this.element.trigger(a)},jPlayerFlashEvent:function(a,c){if(a===b.jPlayer.event.ready)if(this.internal.ready){if(this.flash.gate){if(this.status.srcSet){var d=this.status.currentTime,e=this.status.paused;this.setMedia(this.status.media),d>0&&(e?this.pause(d):this.play(d))}this._trigger(b.jPlayer.event.flashreset)}}else this.internal.ready=!0,this.internal.flash.jq.css({width:"0px",height:"0px"}),this.version.flash=c.version,this.version.needFlash!==this.version.flash&&this._error({type:b.jPlayer.error.VERSION,context:this.version.flash,message:b.jPlayer.errorMsg.VERSION+this.version.flash,hint:b.jPlayer.errorHint.VERSION}),this._trigger(b.jPlayer.event.repeat),this._trigger(a);if(this.flash.gate)switch(a){case b.jPlayer.event.progress:case b.jPlayer.event.timeupdate:this._getFlashStatus(c),this._updateInterface(),this._trigger(a);break;case b.jPlayer.event.play:this._seeked(),this._updateButtons(!0),this._trigger(a);break;case b.jPlayer.event.pause:case b.jPlayer.event.ended:this._updateButtons(!1),this._trigger(a);break;case b.jPlayer.event.click:this._trigger(a);break;case b.jPlayer.event.error:this.status.waitForLoad=!0,this.status.waitForPlay=!0,this.status.video&&this.internal.flash.jq.css({width:"0px",height:"0px"}),this._validString(this.status.media.poster)&&this.internal.poster.jq.show(),this.css.jq.videoPlay.length&&this.status.video&&this.css.jq.videoPlay.show(),this.status.video?this._flash_setVideo(this.status.media):this._flash_setAudio(this.status.media),this._updateButtons(!1),this._error({type:b.jPlayer.error.URL,context:c.src,message:b.jPlayer.errorMsg.URL,hint:b.jPlayer.errorHint.URL});break;case b.jPlayer.event.seeking:this._seeking(),this._trigger(a);break;case b.jPlayer.event.seeked:this._seeked(),this._trigger(a);break;case b.jPlayer.event.ready:break;default:this._trigger(a)}return!1},_getFlashStatus:function(a){this.status.seekPercent=a.seekPercent,this.status.currentPercentRelative=a.currentPercentRelative,this.status.currentPercentAbsolute=a.currentPercentAbsolute,this.status.currentTime=a.currentTime,this.status.duration=a.duration,this.status.readyState=4,this.status.networkState=0,this.status.playbackRate=1,this.status.ended=!1},_updateButtons:function(a){a!==f&&(this.status.paused=!a,this.css.jq.play.length&&this.css.jq.pause.length&&(a?(this.css.jq.play.hide(),this.css.jq.pause.show()):(this.css.jq.play.show(),this.css.jq.pause.hide()))),this.css.jq.restoreScreen.length&&this.css.jq.fullScreen.length&&(this.status.noFullScreen?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.hide()):this.options.fullScreen?(this.css.jq.fullScreen.hide(),this.css.jq.restoreScreen.show()):(this.css.jq.fullScreen.show(),this.css.jq.restoreScreen.hide())),this.css.jq.repeat.length&&this.css.jq.repeatOff.length&&(this.options.loop?(this.css.jq.repeat.hide(),this.css.jq.repeatOff.show()):(this.css.jq.repeat.show(),this.css.jq.repeatOff.hide()))},_updateInterface:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.width(this.status.seekPercent+"%"),this.css.jq.playBar.length&&this.css.jq.playBar.width(this.status.currentPercentRelative+"%"),this.css.jq.currentTime.length&&this.css.jq.currentTime.text(b.jPlayer.convertTime(this.status.currentTime)),this.css.jq.duration.length&&this.css.jq.duration.text(b.jPlayer.convertTime(this.status.duration))},_seeking:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.addClass("jp-seeking-bg")},_seeked:function(){this.css.jq.seekBar.length&&this.css.jq.seekBar.removeClass("jp-seeking-bg")},_resetGate:function(){this.html.audio.gate=!1,this.html.video.gate=!1,this.flash.gate=!1},_resetActive:function(){this.html.active=!1,this.flash.active=!1},setMedia:function(a){var c=this,d=!1,e=this.status.media.poster!==a.poster;this._resetMedia(),this._resetGate(),this._resetActive(),b.each(this.formats,function(e,f){var i="video"===c.format[f].media;if(b.each(c.solutions,function(b,e){if(c[e].support[f]&&c._validString(a[f])){var g="html"===e;return i?(g?(c.html.video.gate=!0,c._html_setVideo(a),c.html.active=!0):(c.flash.gate=!0,c._flash_setVideo(a),c.flash.active=!0),c.css.jq.videoPlay.length&&c.css.jq.videoPlay.show(),c.status.video=!0):(g?(c.html.audio.gate=!0,c._html_setAudio(a),c.html.active=!0):(c.flash.gate=!0,c._flash_setAudio(a),c.flash.active=!0),c.css.jq.videoPlay.length&&c.css.jq.videoPlay.hide(),c.status.video=!1),d=!0,!1}}),d)return!1}),d?(this.status.nativeVideoControls&&this.html.video.gate||!this._validString(a.poster)||(e?this.htmlElement.poster.src=a.poster:this.internal.poster.jq.show()),this.status.srcSet=!0,this.status.media=b.extend({},a),this._updateButtons(!1),this._updateInterface()):this._error({type:b.jPlayer.error.NO_SUPPORT,context:"{supplied:'"+this.options.supplied+"'}",message:b.jPlayer.errorMsg.NO_SUPPORT,hint:b.jPlayer.errorHint.NO_SUPPORT})},_resetMedia:function(){this._resetStatus(),this._updateButtons(!1),this._updateInterface(),this._seeked(),this.internal.poster.jq.hide(),clearTimeout(this.internal.htmlDlyCmdId),this.html.active?this._html_resetMedia():this.flash.active&&this._flash_resetMedia()},clearMedia:function(){this._resetMedia(),this.html.active?this._html_clearMedia():this.flash.active&&this._flash_clearMedia(),this._resetGate(),this._resetActive()},load:function(){this.status.srcSet?this.html.active?this._html_load():this.flash.active&&this._flash_load():this._urlNotSetError("load")},play:function(a){a="number"==typeof a?a:NaN,this.status.srcSet?this.html.active?this._html_play(a):this.flash.active&&this._flash_play(a):this._urlNotSetError("play")},videoPlay:function(){this.play()},pause:function(a){a="number"==typeof a?a:NaN,this.status.srcSet?this.html.active?this._html_pause(a):this.flash.active&&this._flash_pause(a):this._urlNotSetError("pause")},pauseOthers:function(){var a=this;b.each(this.instances,function(b,d){a.element!==d&&d.data("jPlayer").status.srcSet&&d.jPlayer("pause")})},stop:function(){this.status.srcSet?this.html.active?this._html_pause(0):this.flash.active&&this._flash_pause(0):this._urlNotSetError("stop")},playHead:function(a){a=this._limitValue(a,0,100),this.status.srcSet?this.html.active?this._html_playHead(a):this.flash.active&&this._flash_playHead(a):this._urlNotSetError("playHead")},_muted:function(a){this.options.muted=a,this.html.used&&this._html_mute(a),this.flash.used&&this._flash_mute(a),!this.html.video.gate&&!this.html.audio.gate&&(this._updateMute(a),this._updateVolume(this.options.volume),this._trigger(b.jPlayer.event.volumechange))},mute:function(a){a=a===f||!!a,this._muted(a)},unmute:function(a){a=a===f||!!a,this._muted(!a)},_updateMute:function(a){a===f&&(a=this.options.muted),this.css.jq.mute.length&&this.css.jq.unmute.length&&(this.status.noVolume?(this.css.jq.mute.hide(),this.css.jq.unmute.hide()):a?(this.css.jq.mute.hide(),this.css.jq.unmute.show()):(this.css.jq.mute.show(),this.css.jq.unmute.hide()))},volume:function(a){a=this._limitValue(a,0,1),this.options.volume=a,this.html.used&&this._html_volume(a),this.flash.used&&this._flash_volume(a),!this.html.video.gate&&!this.html.audio.gate&&(this._updateVolume(a),this._trigger(b.jPlayer.event.volumechange))},volumeBar:function(a){if(this.css.jq.volumeBar.length){var b=this.css.jq.volumeBar.offset(),d=a.pageX-b.left,e=this.css.jq.volumeBar.width();a=this.css.jq.volumeBar.height()-a.pageY+b.top,b=this.css.jq.volumeBar.height();this.options.verticalVolume?this.volume(a/b):this.volume(d/e)}this.options.muted&&this._muted(!1)},volumeBarValue:function(a){this.volumeBar(a)},_updateVolume:function(a){a===f&&(a=this.options.volume),a=this.options.muted?0:a,this.status.noVolume?(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.hide(),this.css.jq.volumeBarValue.length&&this.css.jq.volumeBarValue.hide(),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.hide()):(this.css.jq.volumeBar.length&&this.css.jq.volumeBar.show(),this.css.jq.volumeBarValue.length&&(this.css.jq.volumeBarValue.show(),this.css.jq.volumeBarValue[this.options.verticalVolume?"height":"width"](100*a+"%")),this.css.jq.volumeMax.length&&this.css.jq.volumeMax.show())},volumeMax:function(){this.volume(1),this.options.muted&&this._muted(!1)},_cssSelectorAncestor:function(a){var c=this;this.options.cssSelectorAncestor=a,this._removeUiClass(),this.ancestorJq=a?b(a):[],a&&1!==this.ancestorJq.length&&this._warning({type:b.jPlayer.warning.CSS_SELECTOR_COUNT,context:a,message:b.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.ancestorJq.length+" found for cssSelectorAncestor.",hint:b.jPlayer.warningHint.CSS_SELECTOR_COUNT}),this._addUiClass(),b.each(this.options.cssSelector,function(a,b){c._cssSelector(a,b)})},_cssSelector:function(a,c){var d=this;"string"==typeof c?b.jPlayer.prototype.options.cssSelector[a]?(this.css.jq[a]&&this.css.jq[a].length&&this.css.jq[a].unbind(".jPlayer"),this.options.cssSelector[a]=c,this.css.cs[a]=this.options.cssSelectorAncestor+" "+c,this.css.jq[a]=c?b(this.css.cs[a]):[],this.css.jq[a].length&&this.css.jq[a].bind("click.jPlayer",function(c){return d[a](c),b(this).blur(),!1}),c&&1!==this.css.jq[a].length&&this._warning({type:b.jPlayer.warning.CSS_SELECTOR_COUNT,context:this.css.cs[a],message:b.jPlayer.warningMsg.CSS_SELECTOR_COUNT+this.css.jq[a].length+" found for "+a+" method.",hint:b.jPlayer.warningHint.CSS_SELECTOR_COUNT})):this._warning({type:b.jPlayer.warning.CSS_SELECTOR_METHOD,context:a,message:b.jPlayer.warningMsg.CSS_SELECTOR_METHOD,hint:b.jPlayer.warningHint.CSS_SELECTOR_METHOD}):this._warning({type:b.jPlayer.warning.CSS_SELECTOR_STRING,context:c,message:b.jPlayer.warningMsg.CSS_SELECTOR_STRING,hint:b.jPlayer.warningHint.CSS_SELECTOR_STRING})},seekBar:function(a){if(this.css.jq.seekBar){var b=this.css.jq.seekBar.offset();a=a.pageX-b.left,b=this.css.jq.seekBar.width();this.playHead(100*a/b)}},playBar:function(a){this.seekBar(a)},repeat:function(){this._loop(!0)},repeatOff:function(){this._loop(!1)},_loop:function(a){this.options.loop!==a&&(this.options.loop=a,this._updateButtons(),this._trigger(b.jPlayer.event.repeat))},currentTime:function(){},duration:function(){},gui:function(){},noSolution:function(){},option:function(a,c){var d=a;if(0===arguments.length)return b.extend(!0,{},this.options);if("string"==typeof a){var e=a.split(".");if(c===f){d=b.extend(!0,{},this.options);for(var g=0;g<e.length;g++){if(d[e[g]]===f)return this._warning({type:b.jPlayer.warning.OPTION_KEY,context:a,message:b.jPlayer.warningMsg.OPTION_KEY,hint:b.jPlayer.warningHint.OPTION_KEY}),f;d=d[e[g]]}return d}g=d={};for(var h=0;h<e.length;h++)h<e.length-1?(g[e[h]]={},g=g[e[h]]):g[e[h]]=c}return this._setOptions(d),this},_setOptions:function(a){var c=this;return b.each(a,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,c){var d=this;switch(a){case"volume":this.volume(c);break;case"muted":this._muted(c);break;case"cssSelectorAncestor":this._cssSelectorAncestor(c);break;case"cssSelector":b.each(c,function(a,b){d._cssSelector(a,b)});break;case"fullScreen":this.options[a]!==c&&(this._removeUiClass(),this.options[a]=c,this._refreshSize());break;case"size":!this.options.fullScreen&&this.options[a].cssClass!==c.cssClass&&this._removeUiClass(),this.options[a]=b.extend({},this.options[a],c),this._refreshSize();break;case"sizeFull":this.options.fullScreen&&this.options[a].cssClass!==c.cssClass&&this._removeUiClass(),this.options[a]=b.extend({},this.options[a],c),this._refreshSize();break;case"autohide":this.options[a]=b.extend({},this.options[a],c),this._updateAutohide();break;case"loop":this._loop(c);break;case"nativeVideoControls":this.options[a]=b.extend({},this.options[a],c),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this._restrictNativeVideoControls(),this._updateNativeVideoControls();break;case"noFullScreen":this.options[a]=b.extend({},this.options[a],c),this.status.nativeVideoControls=this._uaBlocklist(this.options.nativeVideoControls),this.status.noFullScreen=this._uaBlocklist(this.options.noFullScreen),this._restrictNativeVideoControls(),this._updateButtons();break;case"noVolume":this.options[a]=b.extend({},this.options[a],c),this.status.noVolume=this._uaBlocklist(this.options.noVolume),this._updateVolume(),this._updateMute();break;case"emulateHtml":this.options[a]!==c&&((this.options[a]=c)?this._emulateHtmlBridge():this._destroyHtmlBridge())}return this},_refreshSize:function(){this._setSize(),this._addUiClass(),this._updateSize(),this._updateButtons(),this._updateAutohide(),this._trigger(b.jPlayer.event.resize)},_setSize:function(){this.options.fullScreen?(this.status.width=this.options.sizeFull.width,this.status.height=this.options.sizeFull.height,this.status.cssClass=this.options.sizeFull.cssClass):(this.status.width=this.options.size.width,this.status.height=this.options.size.height,this.status.cssClass=this.options.size.cssClass),this.element.css({width:this.status.width,height:this.status.height})},_addUiClass:function(){this.ancestorJq.length&&this.ancestorJq.addClass(this.status.cssClass)},_removeUiClass:function(){this.ancestorJq.length&&this.ancestorJq.removeClass(this.status.cssClass)},_updateSize:function(){this.internal.poster.jq.css({width:this.status.width,height:this.status.height}),!this.status.waitForPlay&&this.html.active&&this.status.video||this.html.video.available&&this.html.used&&this.status.nativeVideoControls?this.internal.video.jq.css({width:this.status.width,height:this.status.height}):!this.status.waitForPlay&&this.flash.active&&this.status.video&&this.internal.flash.jq.css({width:this.status.width,height:this.status.height})},_updateAutohide:function(){var a=this,b=function(){a.css.jq.gui.fadeIn(a.options.autohide.fadeIn,function(){clearTimeout(a.internal.autohideId),a.internal.autohideId=setTimeout(function(){a.css.jq.gui.fadeOut(a.options.autohide.fadeOut)},a.options.autohide.hold)})};this.css.jq.gui.length&&(this.css.jq.gui.stop(!0,!0),clearTimeout(this.internal.autohideId),this.element.unbind(".jPlayerAutohide"),this.css.jq.gui.unbind(".jPlayerAutohide"),this.status.nativeVideoControls?this.css.jq.gui.hide():this.options.fullScreen&&this.options.autohide.full||!this.options.fullScreen&&this.options.autohide.restored?(this.element.bind("mousemove.jPlayer.jPlayerAutohide",b),this.css.jq.gui.bind("mousemove.jPlayer.jPlayerAutohide",b),this.css.jq.gui.hide()):this.css.jq.gui.show())},fullScreen:function(){this._setOption("fullScreen",!0)},restoreScreen:function(){this._setOption("fullScreen",!1)},_html_initMedia:function(){this.htmlElement.media.src=this.status.src,"none"!==this.options.preload&&this._html_load(),this._trigger(b.jPlayer.event.timeupdate)},_html_setAudio:function(a){var c=this;b.each(this.formats,function(b,e){if(c.html.support[e]&&a[e])return c.status.src=a[e],c.status.format[e]=!0,c.status.formatType=e,!1}),this.htmlElement.media=this.htmlElement.audio,this._html_initMedia()},_html_setVideo:function(a){var c=this;b.each(this.formats,function(b,e){if(c.html.support[e]&&a[e])return c.status.src=a[e],c.status.format[e]=!0,c.status.formatType=e,!1}),this.status.nativeVideoControls&&(this.htmlElement.video.poster=this._validString(a.poster)?a.poster:""),this.htmlElement.media=this.htmlElement.video,this._html_initMedia()},_html_resetMedia:function(){this.htmlElement.media&&(this.htmlElement.media.id===this.internal.video.id&&!this.status.nativeVideoControls&&this.internal.video.jq.css({width:"0px",height:"0px"}),this.htmlElement.media.pause())},_html_clearMedia:function(){this.htmlElement.media&&(this.htmlElement.media.src="",this.htmlElement.media.load())},_html_load:function(){this.status.waitForLoad&&(this.status.waitForLoad=!1,this.htmlElement.media.load()),clearTimeout(this.internal.htmlDlyCmdId)},_html_play:function(a){var b=this;this._html_load();var media=this.htmlElement.media;if(media.pause(),setTimeout(function(){media.play()},150),!isNaN(a))try{media.currentTime=a}catch(d){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.play(a)},150))}this._html_checkWaitForPlay()},_html_pause:function(a){var b=this;if(a>0?this._html_load():clearTimeout(this.internal.htmlDlyCmdId),this.htmlElement.media.pause(),!isNaN(a))try{this.htmlElement.media.currentTime=a}catch(d){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.pause(a)},100))}a>0&&this._html_checkWaitForPlay()},_html_playHead:function(a){var b=this;this._html_load();try{if("object"==typeof this.htmlElement.media.seekable&&this.htmlElement.media.seekable.length>0)this.htmlElement.media.currentTime=a*this.htmlElement.media.seekable.end(this.htmlElement.media.seekable.length-1)/100;else{if(!(this.htmlElement.media.duration>0)||isNaN(this.htmlElement.media.duration))throw"e";this.htmlElement.media.currentTime=a*this.htmlElement.media.duration/100}}catch(d){return void(this.internal.htmlDlyCmdId=setTimeout(function(){b.playHead(a)},100))}this.status.waitForLoad||this._html_checkWaitForPlay()},_html_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.video.jq.css({width:this.status.width,height:this.status.height})))},_html_volume:function(a){this.html.audio.available&&(this.htmlElement.audio.volume=a),this.html.video.available&&(this.htmlElement.video.volume=a)},_html_mute:function(a){this.html.audio.available&&(this.htmlElement.audio.muted=a),this.html.video.available&&(this.htmlElement.video.muted=a)},_flash_setAudio:function(a){var c=this;try{b.each(this.formats,function(b,d){if(c.flash.support[d]&&a[d]){switch(d){case"m4a":case"fla":c._getMovie().fl_setAudio_m4a(a[d]);break;case"mp3":c._getMovie().fl_setAudio_mp3(a[d])}return c.status.src=a[d],c.status.format[d]=!0,c.status.formatType=d,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(d){this._flashError(d)}},_flash_setVideo:function(a){var c=this;try{b.each(this.formats,function(b,d){if(c.flash.support[d]&&a[d]){switch(d){case"m4v":case"flv":c._getMovie().fl_setVideo_m4v(a[d])}return c.status.src=a[d],c.status.format[d]=!0,c.status.formatType=d,!1}}),"auto"===this.options.preload&&(this._flash_load(),this.status.waitForLoad=!1)}catch(d){this._flashError(d)}},_flash_resetMedia:function(){this.internal.flash.jq.css({width:"0px",height:"0px"}),this._flash_pause(NaN)},_flash_clearMedia:function(){try{this._getMovie().fl_clearMedia()}catch(a){this._flashError(a)}},_flash_load:function(){try{this._getMovie().fl_load()}catch(a){this._flashError(a)}this.status.waitForLoad=!1},_flash_play:function(a){try{this._getMovie().fl_play(a)}catch(b){this._flashError(b)}this.status.waitForLoad=!1,this._flash_checkWaitForPlay()},_flash_pause:function(a){try{this._getMovie().fl_pause(a)}catch(b){this._flashError(b)}a>0&&(this.status.waitForLoad=!1,this._flash_checkWaitForPlay())},_flash_playHead:function(a){try{this._getMovie().fl_play_head(a)}catch(b){this._flashError(b)}this.status.waitForLoad||this._flash_checkWaitForPlay()},_flash_checkWaitForPlay:function(){this.status.waitForPlay&&(this.status.waitForPlay=!1,this.css.jq.videoPlay.length&&this.css.jq.videoPlay.hide(),this.status.video&&(this.internal.poster.jq.hide(),this.internal.flash.jq.css({width:this.status.width,height:this.status.height})))},_flash_volume:function(a){try{this._getMovie().fl_volume(a)}catch(b){this._flashError(b)}},_flash_mute:function(a){try{this._getMovie().fl_mute(a)}catch(b){this._flashError(b)}},_getMovie:function(){return document[this.internal.flash.id]},_checkForFlash:function(a){var b=!1;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a),b=!0}catch(e){}else navigator.plugins&&navigator.mimeTypes.length>0&&navigator.plugins["Shockwave Flash"]&&navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")>=a&&(b=!0);return b},_validString:function(a){return a&&"string"==typeof a},_limitValue:function(a,b,d){return a<b?b:a>d?d:a},_urlNotSetError:function(a){this._error({type:b.jPlayer.error.URL_NOT_SET,context:a,message:b.jPlayer.errorMsg.URL_NOT_SET,hint:b.jPlayer.errorHint.URL_NOT_SET})},_flashError:function(a){var c;c=this.internal.ready?"FLASH_DISABLED":"FLASH",this._error({type:b.jPlayer.error[c],context:this.internal.flash.swf,message:b.jPlayer.errorMsg[c]+a.message,hint:b.jPlayer.errorHint[c]}),this.internal.flash.jq.css({width:"1px",height:"1px"})},_error:function(a){this._trigger(b.jPlayer.event.error,a),this.options.errorAlerts&&this._alert("Error!"+(a.message?"\n\n"+a.message:"")+(a.hint?"\n\n"+a.hint:"")+"\n\nContext: "+a.context)},_warning:function(a){this._trigger(b.jPlayer.event.warning,f,a),this.options.warningAlerts&&this._alert("Warning!"+(a.message?"\n\n"+a.message:"")+(a.hint?"\n\n"+a.hint:"")+"\n\nContext: "+a.context)},_alert:function(a){alert("jPlayer "+this.version.script+" : id='"+this.internal.self.id+"' : "+a)},_emulateHtmlBridge:function(){var a=this;b.each(b.jPlayer.emulateMethods.split(/\s+/g),function(b,d){a.internal.domNode[d]=function(b){a[d](b)}}),b.each(b.jPlayer.event,function(c,d){var e=!0;b.each(b.jPlayer.reservedEvent.split(/\s+/g),function(a,b){if(b===c)return e=!1}),e&&a.element.bind(d+".jPlayer.jPlayerHtml",function(){a._emulateHtmlUpdate();var b=document.createEvent("Event");b.initEvent(c,!1,!0),a.internal.domNode.dispatchEvent(b)})})},_emulateHtmlUpdate:function(){var a=this;b.each(b.jPlayer.emulateStatus.split(/\s+/g),function(b,d){a.internal.domNode[d]=a.status[d]}),b.each(b.jPlayer.emulateOptions.split(/\s+/g),function(b,d){a.internal.domNode[d]=a.options[d]})},_destroyHtmlBridge:function(){var a=this;this.element.unbind(".jPlayerHtml"),b.each((b.jPlayer.emulateMethods+" "+b.jPlayer.emulateStatus+" "+b.jPlayer.emulateOptions).split(/\s+/g),function(b,d){delete a.internal.domNode[d]})}},b.jPlayer.error={FLASH:"e_flash",FLASH_DISABLED:"e_flash_disabled",NO_SOLUTION:"e_no_solution",NO_SUPPORT:"e_no_support",URL:"e_url",URL_NOT_SET:"e_url_not_set",VERSION:"e_version"},b.jPlayer.errorMsg={FLASH:"jPlayer's Flash fallback is not configured correctly, or a command was issued before the jPlayer Ready event. Details: ",FLASH_DISABLED:"jPlayer's Flash fallback has been disabled by the browser due to the CSS rules you have used. Details: ",NO_SOLUTION:"No solution can be found by jPlayer in this browser. Neither HTML nor Flash can be used.",NO_SUPPORT:"It is not possible to play any media format provided in setMedia() on this browser using your current options.",URL:"Media URL could not be loaded.",URL_NOT_SET:"Attempt to issue media playback commands, while no media url is set.",VERSION:"jPlayer "+b.jPlayer.prototype.version.script+" needs Jplayer.swf version "+b.jPlayer.prototype.version.needFlash+" but found "},b.jPlayer.errorHint={FLASH:"Check your swfPath option and that Jplayer.swf is there.",FLASH_DISABLED:"Check that you have not display:none; the jPlayer entity or any ancestor.",NO_SOLUTION:"Review the jPlayer options: support and supplied.",NO_SUPPORT:"Video or audio formats defined in the supplied option are missing.",URL:"Check media URL is valid.",URL_NOT_SET:"Use setMedia() to set the media URL.",VERSION:"Update jPlayer files."},b.jPlayer.warning={CSS_SELECTOR_COUNT:"e_css_selector_count",CSS_SELECTOR_METHOD:"e_css_selector_method",CSS_SELECTOR_STRING:"e_css_selector_string",OPTION_KEY:"e_option_key"},b.jPlayer.warningMsg={CSS_SELECTOR_COUNT:"The number of css selectors found did not equal one: ",CSS_SELECTOR_METHOD:"The methodName given in jPlayer('cssSelector') is not a valid jPlayer method.",CSS_SELECTOR_STRING:"The methodCssSelector given in jPlayer('cssSelector') is not a String or is empty.",OPTION_KEY:"The option requested in jPlayer('option') is undefined."},b.jPlayer.warningHint={CSS_SELECTOR_COUNT:"Check your css selector and the ancestor.",CSS_SELECTOR_METHOD:"Check your method name.",CSS_SELECTOR_STRING:"Check your css selector is a string.",OPTION_KEY:"Check your option name."}}(jQuery),function(j$,w$){w$.softchalkcard={},w$.softchalkcard._a={},w$.softchalkcard.init=function(xml,params){w$.softchalkcard._a[params.containerId]=new flashcard(params.containerId,j$(xml),params.width,params.height,params.backgroundColor)};var flashcard=function(id,xml,wwidth,hheight,pcolor){var self=this;self.id=id,this.params={bgcolor:pcolor||xml.find("color").text(),showterm:"true"==xml.find("showterm").text(),showdef:"true"==xml.find("showdef").text(),customDeckText:xml.find("customDeckText").text(),wholeDeckText:xml.find("wholeDeckText").text(),showText:xml.find("showText").text(),showCustomText:xml.find("addToText").text(),showTermText:xml.find("showTermText").text(),showDefText:xml.find("showDefText").text(),show_this:!1,addcustom:!1,showcustom:!1,width:wwidth,height:hheight,bigtext:!!xml.find("bigtext").length&&"true"==xml.find("bigtext").text()},this.params.bgcolor="#"+this.params.bgcolor.replace(/#/g,""),this.cards=[],this.cards.current=0,this.cards.refresh=function(){for(var c=0,i=0,l=this.length;i<l;i++)this[i].custom&&(this[i].custom=++c);this.customs=c},xml.find("orderset").each(function(){self.cards.push({term:_parse_string.call(j$(this).find("term").text()),def:_parse_string.call(j$(this).find("def").text()),img:j$(this).find("image").text(),width:parseInt(j$(this).find("width").text()),height:parseInt(j$(this).find("height").text()),custom:!1})}),j$.shuffle(self.cards),_build_view(self)},_build_view=function(self){var _prm=self.params,wrapper=j$("#"+self.id).css({width:_prm.width+"px",height:_prm.height+"px",background:_prm.bgcolor}).append($('<div class="sc-cards-bgimage"></div>').css({width:_prm.width+"px",height:_prm.height+"px"})).addClass("sc-cards-flashCard").click(function(self){return function(){$("#inputf_"+self.id).focus()}}(self)).children(".sc-cards-bgimage");self.wrapper=wrapper,self.content=j$("<div style='position:absolute;z-index:-1;opacity:0'></div>");for(var i=0;i<self.cards.length;i++)self.content.append(j$("<img src='"+self.cards[i].img+"'/>"));wrapper.append(self.content);var contentTemplate=j$('<div><div style="height:308px;"><table border="0" style="height:308px;overflow:hidden;" cellpadding="0" cellspacing="0" width="'+_prm.width+'"><tr class="sc-cards-expression"><td colspan="2" style="overflow: hidden;"><div class="sc-cards-term"></div></td></tr><tr class="sc-cards-description-mode-bigtext-smallimage"><td colspan="2"><img style="display:block" src=""/></td></tr><tr class="sc-card-description-mode-all"><td class="sc-card-description-mode-all-img"><img src="" style="display:block" class="sc-cards-img"/></td><td class="sc-card-description-mode-all-def"><div class="sc-cards-def"></div></td></tr></table></div><div style="height:30px"><div class="sc-cards-status"></div></div></div>'),skeleton=j$('<div><div><table class="controls" border="0" cellpadding="0" cellspacing="0" width="'+_prm.width+'"><tr height="60px"><td width="210px" style=""></td><td width="40px" style="cursor:pointer;"></td><td width="60px" style="cursor:pointer"></td><td width="40px" style="cursor:pointer;"></td><td width="200px" style=""></td></tr></table></div></div>');skeleton.find("div").eq(0).prepend(contentTemplate),self.mode_bigtext_smallimage=skeleton.find(".sc-cards-description-mode-bigtext-smallimage"),self.mode_bigtext_smallimage.img=self.mode_bigtext_smallimage.find("img"),self.img=skeleton.find(".sc-card-description-mode-all-img .sc-cards-img").hide(),self.def=skeleton.find(".sc-card-description-mode-all-def .sc-cards-def"),self.term=skeleton.find(".sc-cards-expression .sc-cards-term").css({width:_prm.width-80+"px"}),self.status=skeleton.find(".sc-cards-status"),self.def_holder=skeleton.find(".sc-card-description-mode-all-def"),self.params.bigtext&&(self.def_holder.addClass("sc-card-mode-big"),self.term.addClass("sc-bigText")),self.showterm=j$('<div class="sc-cards-termText">'+_prm.showTermText+"</div>").data("checked",_prm.showterm).hover(_event_choice_hover_1,_event_choice_hover_2).click(function(){self._switch_showterm()}).addClass("sc-cards-no-select"),_prm.showterm?self.showterm.css({"background-position":"0px -32px"}):(self._switch_showterm(),self._switch_showterm()),self.showdef=j$('<div class="sc-cards-defText">'+_prm.showDefText+"</div>").css({"background-position":"0px 0px"}).data("checked",_prm.showdef).hover(_event_choice_hover_1,_event_choice_hover_2).click(function(){self._switch_showdef()}).addClass("sc-cards-no-select"),_prm.showdef?self.showdef.css({"background-position":"0px -32px"}):(self._switch_showdef(),self._switch_showdef()),self.addcustom=j$('<div class="sc-cards-customText">'+_prm.showCustomText+"</div>").data("checked",!1).hover(_event_choice_hover_1,_event_choice_hover_2).click(function(){self._switch_addcustom()}).addClass("sc-cards-no-select"),self.showcustom=$('<div class="sc-cards-customDeck">'+_prm.customDeckText+"</div>").css({}).data("checked",!1).hover(_event_choice_hover_1,_event_choice_hover_2).click(function(){self._switch_showcustom()}).addClass("sc-cards-no-select").hide(),skeleton.find(".controls").find("tr").children("td").eq(0).css({"vertical-align":"top"}).append(self.showterm,self.showdef),skeleton.find(".controls").find("tr").children("td").eq(1).click(function(){self.prev()}),skeleton.find(".controls").find("tr").children("td").eq(2).addClass("sc-cards-showText").append(_prm.showText).click(function(){self.show_this()}).addClass("sc-cards-no-select"),skeleton.find(".controls").find("tr").children("td").eq(3).click(function(){self.next()}),skeleton.find(".controls").find("tr").children("td").eq(4).css({"vertical-align":"top"}).append(self.addcustom,self.showcustom);var inpC=$('<input class="sc-cards-key-handler" type="button" id="inputf_'+self.id+'"/>').focusin(function(self){return function(){self.wrapper.addClass("sc-selectedQuestion")}}(self)).focusout(function(self){return function(){self.wrapper.removeClass("sc-selectedQuestion")}}(self)).bind("keydown",{self:self},self.handleKeys);wrapper.append(inpC),wrapper.append(skeleton);self.id;self.mode_bigtext_smallimage.dh=(parseInt(self.mode_bigtext_smallimage.find("td").css("padding-top"))||0)+(parseInt(self.mode_bigtext_smallimage.find("td").css("padding-bottom"))||0),skeleton.parents(get_greymatter_class_name()).defer_until_visible(self.update.bind(self))},_view_choice_switch=function(c){var left=this[c].css("background-position").split(" ")[0],h=this.params[c]?-32:-16;this[c].css({"background-position":left+" "+h+"px"})},_event_choice_hover_1=function(){if(!j$(this).data("checked")){var left=j$(this).css("background-position").split(" ")[0];j$(this).css({"background-position":left+" -16px"})}},_event_choice_hover_2=function(){if(!j$(this).data("checked")){var left=j$(this).css("background-position").split(" ")[0];j$(this).css({"background-position":left+" 0px"})}},_parse_string=function(){return decodeURIComponent(this.replace(/\+/gi," "))};flashcard.prototype._switch_showterm=function(){this.params.showterm=!this.params.showterm,this.showterm.data("checked",this.params.showterm),this.term[this.params.showterm?"show":"hide"](),_view_choice_switch.call(this,"showterm")},flashcard.prototype._switch_showdef=function(){this.params.showdef=!this.params.showdef,this.showdef.data("checked",this.params.showdef),this.def[0].style.visibility=this.params.showdef?"visible":"hidden",this.mode_bigtext_smallimage.img.attr("src")?this.mode_bigtext_smallimage.img[this.params.showdef?"show":"hide"]():this.img[this.params.showdef?"show":"hide"](),_view_choice_switch.call(this,"showdef")},flashcard.prototype._switch_addcustom=function(){var c=this.cards,o=c[c.current];o.custom=!o.custom,c.refresh(),this.params.addcustom=o.custom,this.addcustom.data("checked",o.custom),_view_choice_switch.call(this,"addcustom"),this.showcustom[c.customs?"show":"hide"]()},flashcard.prototype._switch_showcustom=function(){"none"!=this.showcustom[0].style.display&&(this.params.showcustom=!this.params.showcustom,this.showcustom.data("checked",this.params.showcustom),_view_choice_switch.call(this,"showcustom"),this.addcustom.css({visibility:this.params.showcustom?"hidden":"visible"}),this.cards.current=this.cards.length-1,this.next(),this.update())},flashcard.prototype.next=function(){var c=this.cards;if(c.current++,c.current==c.length&&(c.current=0),this.params.showcustom)for(;!c[c.current].custom;)c.current++,c.current==c.length&&(c.current=0);this.update()},flashcard.prototype.prev=function(){var c=this.cards;if(c.current--,c.current<0&&(c.current=c.length-1),this.params.showcustom)for(;!c[c.current].custom;)c.current--,c.current<0&&(c.current=c.length-1);this.update()},flashcard.prototype.update=function(){var self=this;this.params.show_this&&(this.params.show_this=!1,this.params.showterm||this.term.hide(),this.params.showdef||(this.def[0].style.visibility="hidden",this.img.hide(),this.mode_bigtext_smallimage.img.hide()));var c=this.cards,n=c.current,i=n+1,len=c.length;if(this.params.showcustom&&(i=c[n].custom,len=c.customs),this.term.html(c[n].term),this.def.html(c[n].def||"&#160;"),this.def_holder.removeClass("sc-card-mode-big-center sc-card-mode-big-middle"),this.mode_bigtext_smallimage.hide(),c[n].img)if(this.img.parent().hide(),this.params.bigtext&&c[n].height<100){this.mode_bigtext_smallimage.img.attr({height:c[n].height+"px",width:c[n].width+"px",display:"block"}),this.mode_bigtext_smallimage.img[0].src=self.content.find("img").eq(n)[0].src,this.mode_bigtext_smallimage.css({height:c[n].height+"px"}),this.mode_bigtext_smallimage.show(),this.def_holder.addClass("sc-card-mode-big-center");var h=c[n].height+this.mode_bigtext_smallimage.dh;this.def_holder.css({height:this.def_holder.height-h+"px"}),this.def.css({height:this.def_holder.height-h+"px"})}else this.img.css({height:c[n].height+"px",width:c[n].width+"px",display:"block"}),this.img[0].src=self.content.find("img").eq(n)[0].src,this.img.parent().css("width",c[n].width+"px"),this.img.parent().show(),this.img.css({display:"block"}),this.def_holder.css({height:this.def_holder.height()+"px"}),this.def.css({height:this.def_holder.height()-10+"px"}),setTimeout(function(){self.img[0].src=self.content.find("img").eq(n)[0].src},300);else this.img.attr("src",""),this.mode_bigtext_smallimage.img.attr("src",""),this.img.parent().hide(),this.def_holder.addClass("sc-card-mode-big-middle").css({height:this.def_holder.height()+"px"}),this.def.css({height:this.def_holder.height()+"px"});this.img[this.params.showdef?"show":"hide"](),this.params.bigtext&&c[n].height<100&&this.mode_bigtext_smallimage.img[this.params.showdef?"show":"hide"](),this.params.showdef?this.def[0].style.visibility="visible":this.def[0].style.visibility="hidden",c[n].img||this.img.hide(),this.status.html(i+" / "+len),this.params.addcustom=c[n].custom,this.addcustom.data("checked",c[n].custom),_view_choice_switch.call(this,"addcustom"),this.addcustom.mouseout()},flashcard.prototype.handleKeys=function(e){var self=e.data.self;switch(e.keyCode){case 39:self.next();break;case 37:self.prev();break;case 74:e.altKey&&self._switch_showterm();break;case 76:e.altKey&&self._switch_showdef();break;case 77:e.altKey&&self._switch_addcustom();break;case 75:e.altKey&&self._switch_showcustom();break;case 13:self.show_this();break;default:return!0}e.preventDefault()},flashcard.prototype.show_this=function(){this.params.show_this=!0,this.term.show(),this.def[0].style.visibility="visible",this.mode_bigtext_smallimage.img.attr("src")?this.mode_bigtext_smallimage.img.css({display:"block"}):this.img.css({display:"block"})},flashcard.prototype.reset=function(){return!1},flashcard.prototype.save_state=function(){return""},flashcard.prototype.load_state=function(){arguments[0].split(";").reverse()},j$.shuffle=function(arr){for(var j,x,i=arr.length;i;j=parseInt(Math.random()*i),x=arr[--i],arr[i]=arr[j],arr[j]=x);}}(jQuery,window),function(jQuery){var domfocus=!1,mousefocus=!1,tabindexcounter=5e3,ascrailcounter=2e3,$=jQuery;var scripts,path,scriptpath=(scripts=document.getElementsByTagName("script"),(path=scripts[scripts.length-1].src.split("?")[0]).split("/").length>0?path.split("/").slice(0,-1).join("/")+"/":""),setAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||!1,clearAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||!1,ScrollMomentumClass=function(nc,hz){var self=this;this.nc=nc,this.hz=hz||!1,this.lasty=0,this.speedy=0,this.lasttime=0,this.snapy=!1,this.demuly=0,this.timer=0,this.time=function(){return(new Date).getTime()},this.reset=function(py){self.stop(),self.lasttime=self.time(),self.speedy=0,self.lasty=py},this.update=function(py){self.lasttime=self.time();var dy=py-self.lasty,newy=(self.hz?nc.getScrollLeft():nc.getScrollTop())+dy,mx=self.hz?self.nc.page.maxw:self.nc.page.maxh;self.snapy=newy<0||newy>mx,self.speedy=dy,self.lasty=py},this.stop=function(){self.timer&&(clearTimeout(self.timer),self.timer=0)},this.hz?this.doSnapy=function(nx){nx<0?self.nc.doScrollLeft(0,60):nx>self.nc.page.maxw&&self.nc.doScrollLeft(self.nc.page.maxw,60)}:this.doSnapy=function(ny){ny<0?self.nc.doScroll(0,60):ny>self.nc.page.maxh&&self.nc.doScroll(self.nc.page.maxh,60)},this.getScroll=this.hz?this.nc.getScrollLeft:this.nc.getScrollTop,this.setScroll=this.hz?this.nc.setScrollLeft:this.nc.setScrollTop,this.doMomentum=function(){var l=self.lasttime,t=self.time();self.speedy=Math.min(60,self.speedy);var chk=l&&t-l<=50;if(!(!self.speedy||!chk)&&self.speedy){var tm=t-l,pageh=self.hz?self.nc.page.maxw:self.nc.page.maxh;self.demuly=0;var onscroll=function(){var ny=Math.floor(self.getScroll()-self.speedy*(1-self.demuly));self.demuly+=ny<0||ny>pageh?.08:.01,self.setScroll(ny),self.hz?self.nc.scroll.x=Math.round(1*ny/self.nc.scrollratio.x):self.nc.scroll.y=Math.round(1*ny/self.nc.scrollratio.y),self.nc.showCursor(),self.demuly<1?self.timer=setTimeout(onscroll,tm):(self.timer=0,self.nc.hideCursor(),self.doSnapy(ny))};onscroll()}else self.snapy&&self.doSnapy(self.getScroll())}},_scrollTop=jQuery.fn.scrollTop;$.cssHooks.scrollTop={get:function(elem,computed,extra){var nice=$.data(elem,"__nicescroll")||!1;return nice&&nice.ishwscroll?nice.getScrollTop():_scrollTop.call(elem)},set:function(elem,value){var nice=$.data(elem,"__nicescroll")||!1;return nice&&nice.ishwscroll?nice.setScrollTop(parseInt(value)):_scrollTop.call(elem,value),this}},jQuery.fn.scrollTop=function(value){if(void 0===value){var nice=this[0]&&$.data(this[0],"__nicescroll")||!1;return nice&&nice.ishwscroll?nice.getScrollTop():_scrollTop.call(this)}return this.each(function(){var nice=$.data(this,"__nicescroll")||!1;nice&&nice.ishwscroll?nice.setScrollTop(parseInt(value)):_scrollTop.call($(this),value)})};var NiceScrollArray=function(doms){var self=this;if(this.length=0,this.name="nicescrollarray",this.each=function(fn){for(var a=0;a<self.length;a++)fn.call(self[a]);return self},this.push=function(nice){self[self.length]=nice,self.length++},this.eq=function(idx){return self[idx]},doms)for(a=0;a<doms.length;a++){var nice=$.data(doms[a],"__nicescroll")||!1;nice&&(this[this.length]=nice,this.length++)}return this};!function(el,lst,fn){for(var a=0;a<lst.length;a++)fn(el,lst[a])}(NiceScrollArray.prototype,["show","hide","onResize","resize","remove","stop"],function(e,n){e[n]=function(){return this.each(function(){this[n].call()})}}),jQuery.fn.getNiceScroll=function(index){return void 0===index?new NiceScrollArray(this):$.data(this[index],"__nicescroll")||!1},jQuery.extend(jQuery.expr[":"],{nicescroll:function(a){return!!$.data(a,"__nicescroll")}}),$.fn.niceScroll=function(wrapper,opt){void 0===opt&&("object"!=typeof wrapper||"jquery"in wrapper||(opt=wrapper,wrapper=!1));var ret=new NiceScrollArray;void 0===opt&&(opt={}),wrapper&&(opt.doc=$(wrapper),opt.win=$(this));var docundef=!("doc"in opt);return docundef||"win"in opt||(opt.win=$(this)),this.each(function(){var nice=$(this).data("__nicescroll")||!1;nice||(opt.doc=docundef?$(this):opt.doc,nice=new function(myopt,me){var self=this;if(this.version="3.0.0-PREVIEW1",this.name="nicescroll",this.me=me,this.opt={doc:$("body"),win:!1,zindex:9e3,cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:40,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:20,preservenativescrolling:!0,railoffset:!1,bouncescroll:!1,spacebarenabled:!0},myopt)for(var a in self.opt)void 0!==myopt[a]&&(self.opt[a]=myopt[a]);this.doc=self.opt.doc,this.id=this.doc&&this.doc[0]&&this.doc[0].id||"",this.ispage=/BODY|HTML/.test(self.opt.win?self.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==self.opt.win,this.win=self.opt.win||(this.ispage?$(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?$(window):this.win,this.body=$("body"),this.iframe=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.onmousedown=!1,this.onmouseup=!1,this.onmousemove=!1,this.onmousewheel=!1,this.onkeypress=!1,this.ongesturezoom=!1,this.onclick=!1,this.view=!1,this.page=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.scrollmom=!1;do{this.id="ascrail"+ascrailcounter++}while(document.getElementById(this.id));this.rail=!1,this.cursor=!1,this.cursorfreezed=!1,this.zoom=!1,this.zoomactive=!1,this.hasfocus=!1,this.hasmousefocus=!1,this.visibility=!0,this.locked=!1,self.nativescrollingarea=!1,this.events=[],this.saved={},this.delaylist={};var domtest=document.createElement("DIV");if(this.isopera="opera"in window,this.isie="all"in document&&"attachEvent"in domtest&&!this.isopera,this.isieold=this.isie&&!("msInterpolationMode"in domtest.style),this.isie7=this.isie&&!this.isieold&&(!("documentMode"in document)||7==document.documentMode),this.isie8=this.isie&&"documentMode"in document&&8==document.documentMode,this.isie9=this.isie&&"performance"in window&&document.documentMode>=9,this.ismozilla="MozAppearance"in domtest.style,this.ischrome="chrome"in window,this.cantouch="ontouchstart"in document.documentElement,this.isios=this.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),this.isios4=this.isios&&!("seal"in Object),self.opt.hwacceleration){this.trstyle=window.opera?"OTransform":document.all?"msTransform":void 0!==domtest.style.webkitTransform?"webkitTransform":void 0!==domtest.style.MozTransform&&"MozTransform",this.trstyle&&void 0===domtest.style[this.trstyle]&&(this.trstyle=!1),this.hastransform=0!=this.trstyle,this.hastransform&&(domtest.style[this.trstyle]="translate3d(1px,2px,3px)",this.hastranslate3d=/translate3d/.test(domtest.style[this.trstyle])),this.transitionstyle=!1,this.prefixstyle="",this.transitionend=!1;var check=["transition","webkitTransition","MozTransition","OTransition","msTransition","KhtmlTransition"],prefix=["","-webkit-","-moz-","-o-","-ms-","-khtml-"],evs=["transitionEnd","webkitTransitionEnd","transitionend","oTransitionEnd","msTransitionEnd","KhtmlTransitionEnd"];for(a=0;a<check.length;a++)if(check[a]in domtest.style){this.transitionstyle=check[a],this.prefixstyle=prefix[a],this.transitionend=evs[a];break}this.hastransition=this.transitionstyle}else this.trstyle=!1,this.hastransform=!1,this.hastranslate3d=!1,this.transitionstyle=!1,this.hastransition=!1,this.transitionend=!1;this.cursorgrabvalue="",self.opt.grabcursorenabled&&self.opt.touchbehavior&&(this.cursorgrabvalue=function(){if(self.ischrome||self.isie&&!self.isie9)var lst=["url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur)","n-resize"];else lst=["grab","-moz-grab","-webkit-grab","url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur)","n-resize"];for(var a=0;a<lst.length;a++){var p=lst[a];if(domtest.style.cursor=p,domtest.style.cursor==p)return p}return""}());domtest=null,this.ishwscroll=self.hastransform&&self.opt.hwacceleration&&self.haswrapper,this.delayed=function(name,fn,tm){var dd=self.delaylist[name],nw=(new Date).getTime();if(dd&&dd.tt)return!1;dd&&dd.last+tm>nw&&!dd.tt?self.delaylist[name]={last:nw+tm,tt:setTimeout(function(){self.delaylist[name].tt=0,fn.call()},tm)}:dd&&dd.tt||(self.delaylist[name]={last:nw,tt:0},setTimeout(function(){fn.call()},0))},this.css=function(el,pars){for(var n in pars)self.saved.css.push([el,n,el.css(n)]),el.css(n,pars[n])},this.scrollTop=function(val){return void 0===val?self.getScrollTop():self.setScrollTop(val)},BezierClass=function(st,ed,spd,p1,p2,p3,p4){this.st=st,this.ed=ed,this.spd=spd,this.p1=p1||0,this.p2=p2||1,this.p3=p3||0,this.p4=p4||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st},BezierClass.prototype={B2:function(t){return 3*t*t*(1-t)},B3:function(t){return 3*t*(1-t)*(1-t)},B4:function(t){return(1-t)*(1-t)*(1-t)},getNow:function(){var pc=1-((new Date).getTime()-this.ts)/this.spd,bz=this.B2(pc)+this.B3(pc)+this.B4(pc);return pc<0?this.ed:this.st+Math.round(this.df*bz)},update:function(ed,spd){return this.st=this.getNow(),this.ed=ed,this.spd=spd,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll?(this.doc.translate={x:0,y:0},this.hastranslate3d&&this.doc.css(this.prefixstyle+"backface-visibility","hidden"),this.getScrollTop=function(last){return self.timerscroll&&!last?self.timerscroll.bz.getNow():self.doc.translate.y},document.createEvent?this.notifyScrollEvent=function(el){var e=document.createEvent("UIEvents");e.initUIEvent("scroll",!1,!0,window,1),el.dispatchEvent(e)}:document.fireEvent?this.notifyScrollEvent=function(el){var e=document.createEventObject();el.fireEvent("onscroll"),e.cancelBubble=!0}:this.notifyScrollEvent=function(el){},this.hastranslate3d?this.setScrollTop=function(val,silent){self.doc.css(self.trstyle,"translate3d(0px,"+-1*val+"px,0px)"),self.doc.translate.y=val,silent||self.notifyScrollEvent(self.win[0])}:this.setScrollTop=function(val,silent){self.doc.css(self.trstyle,"translate(0px,"+-1*val+"px)"),self.doc.translate.y=val,silent||self.notifyScrollEvent(self.win[0])}):(this.getScrollTop=function(){return self.docscroll.scrollTop()},this.setScrollTop=function(val){return self.docscroll.scrollTop(val)},this.getScrollLeft=function(){return self.docscroll.scrollLeft()},this.setScrollLeft=function(val){return self.docscroll.scrollLeft(val)}),this.getTarget=function(e){return!!e&&(e.target?e.target:!!e.srcElement&&e.srcElement)},this.hasParent=function(e,id){if(!e)return!1;for(var el=e.target||e.srcElement||e||!1;el&&el.id!=id;)el=el.parentNode||!1;return!1!==el},this.updateScrollBar=function(len){if(self.ishwscroll)self.rail.css({height:self.win.innerHeight()});else{var wpos=self.win.offset();(pos={top:wpos.top,left:wpos.left}).top+=2;var brd=(self.win.outerWidth()-self.win.innerWidth())/2;pos.left+=self.win.innerWidth()+brd-self.rail.width-1;var off=self.opt.railoffset;if(off&&(off.top&&(pos.top+=off.top),off.left&&(pos.left+=off.left)),self.rail.css({top:pos.top,left:pos.left,height:len?len.h:self.win.innerHeight()}),self.zoom&&self.zoom.css({top:pos.top+1,left:pos.left-20}),self.railh){var pos,y=(pos={top:wpos.top,left:wpos.left}).top+self.win.height()-self.railh.height,x=pos.left;self.railh.css({top:y,left:x,width:self.railh.width})}}},self.hasanimationframe=setAnimationFrame,self.hascancelanimationframe=clearAnimationFrame,self.hasanimationframe?self.hascancelanimationframe||(clearAnimationFrame=function(){self.cancelAnimationFrame=!0}):(setAnimationFrame=function(fn){return setTimeout(fn,Math.round(1e3/60))},clearAnimationFrame=clearInterval),this.init=function(){if(self.saved.css=[],!self.ispage||!self.cantouch&&!self.isieold){var cont=self.docscroll;self.ispage&&(cont=self.haswrapper?self.win:self.doc),self.css(cont,{"overflow-y":"hidden"}),self.ispage&&self.isie7&&"BODY"==self.win[0].nodeName&&self.css($("html"),{"overflow-y":"hidden"}),(cursor=$(document.createElement("div"))).css({position:"relative",top:0,float:"right",width:self.opt.cursorwidth,height:"0px","background-color":self.opt.cursorcolor,border:self.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":self.opt.cursorborderradius,"-moz-border-radius":self.opt.cursorborderradius,"border-radius":self.opt.cursorborderradius}),cursor.hborder=parseFloat(cursor.outerHeight()-cursor.innerHeight()),self.cursor=cursor;var rail=$(document.createElement("div"));rail.attr("id",self.id),rail.width=1+Math.max(parseFloat(self.opt.cursorwidth),cursor.outerWidth()),rail.css({"padding-left":"0px","padding-right":"1px",width:rail.width+"px",zIndex:self.ispage?self.opt.zindex:self.opt.zindex+2,background:self.opt.background}),rail.append(cursor),rail.visibility=!0,self.rail=rail,self.rail.drag=!1;var cursor,zoom=!1;!self.opt.boxzoom||self.ispage||self.isieold||(zoom=document.createElement("div"),self.bind(zoom,"click",self.doZoom),self.zoom=$(zoom),self.zoom.css({cursor:"pointer","z-index":self.opt.zindex,backgroundImage:"url("+scriptpath+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),self.opt.dblclickzoom&&self.bind(self.win,"dblclick",self.doZoom),self.cantouch&&self.opt.gesturezoom&&(self.ongesturezoom=function(e){return e.scale>1.5&&self.doZoomIn(e),e.scale<.8&&self.doZoomOut(e),self.cancelEvent(e)},self.bind(self.win,"gestureend",self.ongesturezoom))),self.css(cont,{"overflow-x":"hidden"}),(cursor=$(document.createElement("div"))).css({position:"relative",top:0,height:self.opt.cursorwidth,width:"0px","background-color":self.opt.cursorcolor,border:self.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":self.opt.cursorborderradius,"-moz-border-radius":self.opt.cursorborderradius,"border-radius":self.opt.cursorborderradius}),cursor.wborder=parseFloat(cursor.outerWidth()-cursor.innerWidth()),self.cursorh=cursor;var railh=$(document.createElement("div"));if(railh.attr("id",self.id+"-h"),railh.height=1+Math.max(parseFloat(self.opt.cursorwidth),cursor.outerHeight()),railh.css({height:railh.height+"px",zIndex:self.ispage?self.opt.zindex:self.opt.zindex+2,background:self.opt.background}),railh.append(cursor),railh.visibility=!0,self.railh=railh,self.railh.drag=!1,self.ispage)rail.css({position:"fixed",top:"0px",right:"0px",height:"100%"}),self.body.append(rail),self.railh&&(railh.css({position:"fixed",bottom:"0px",left:"0px",width:"100%"}),self.body.append(railh));else if(self.ishwscroll){"static"==self.win.css("position")&&self.css(self.win,{position:"relative"});var bd="HTML"==self.win[0].nodeName?self.body:self.win;self.zoom&&(self.zoom.css({position:"absolute",top:1,right:0,"margin-right":rail.width+4}),bd.append(self.zoom)),rail.css({position:"absolute",top:0,right:0}),bd.append(rail)}else rail.css({position:"absolute"}),self.zoom&&self.zoom.css({position:"absolute"}),self.updateScrollBar(),self.body.append(rail),self.zoom&&self.body.append(self.zoom),self.railh&&(railh.css({position:"absolute"}),self.body.append(railh));!1===self.opt.autohidemode?self.autohidedom=!1:!0===self.opt.autohidemode?self.autohidedom=self.rail:"cursor"==self.opt.autohidemode&&(self.autohidedom=self.cursor),self.cantouch||self.opt.touchbehavior?(self.scrollmom={y:new ScrollMomentumClass(self),x:!!self.railh&&new ScrollMomentumClass(self,!0)},self.onmousedown=function(e){if(!self.locked&&(self.cancelScroll(),self.rail.drag={x:e.screenX,y:e.screenY,sx:self.scroll.x,sy:self.scroll.y,st:self.getScrollTop(),sl:self.getScrollLeft()},self.hasmoving=!1,self.scrollmom.y.reset(e.screenY),!self.cantouch))return self.cancelEvent(e)},self.onmouseup=function(e){if(self.rail.drag&&(self.scrollmom.y.doMomentum(),self.scrollmom.x&&self.scrollmom.x.doMomentum(),self.rail.drag=!1,self.hasmoving))return self.hideCursor(),self.cancelEvent(e)},self.onclick=function(e){if(self.hasmoving)return self.cancelEvent(e)},self.onmousemove=function(e){if(self.rail.drag){self.hasmoving=!0;var my=e.screenY-self.rail.drag.y,fy=e.screenY,ny=self.rail.drag.st-my;self.ishwscroll?ny<0?(ny=Math.round(ny/2),fy=0):ny>self.page.maxh&&(ny=self.page.maxh+Math.round((ny-self.page.maxh)/2),fy=0):(ny<0&&(ny=0),ny>self.page.maxh&&(ny=self.page.maxh));var nx=!1;if(self.railh){var mx=e.screenX-self.rail.drag.x,fx=e.screenX;nx=self.rail.drag.sl-mx,self.ishwscroll?nx<0?(nx=Math.round(nx/2),fx=0):nx>self.page.maxw&&(nx=self.page.maxw+Math.round((nx-self.page.maxw)/2),fx=0):(nx<0&&(nx=0),nx>self.page.maxw&&(nx=self.page.maxw)),self.scroll.x=Math.round(1*nx/self.scrollratio.x)}return self.showCursor(ny),self.prepareTransition&&self.prepareTransition(0),self.setScrollTop(ny),self.scrollmom.y.update(fy),!1!==nx&&(self.setScrollLeft(nx),self.scrollmom.x.update(fx)),self.cancelEvent(e)}},self.cursorgrabvalue&&(self.css(self.ispage?self.doc:self.win,{cursor:self.cursorgrabvalue}),self.css(self.rail,{cursor:self.cursorgrabvalue}))):(self.onmousedown=function(e){return self.locked?self.cancelEvent(e):(self.cancelScroll(),self.rail.drag={x:e.screenX,y:e.screenY,sx:self.scroll.x,sy:self.scroll.y},self.cancelEvent(e))},self.onmouseup=function(e){if(self.rail.drag)return self.rail.drag=!1,self.cancelEvent(e)},self.onmousemove=function(e){if(self.rail.drag){var py=!1;if(!self.rail.drag.locked||"v"==self.rail.drag.locked){self.scroll.y=self.rail.drag.sy+(e.screenY-self.rail.drag.y),self.scroll.y<0&&(self.scroll.y=0);var my=self.scrollvaluemax;self.scroll.y>my&&(self.scroll.y=my),py=Math.round(self.scroll.y*self.scrollratio.y)}var px=!1;if(self.cursorh&&(!self.rail.drag.locked||"h"==self.rail.drag.locked)){self.scroll.x=self.rail.drag.sx+(e.screenX-self.rail.drag.x),self.scroll.x<0&&(self.scroll.x=0);var mx=self.scrollvaluemaxw;self.scroll.x>mx&&(self.scroll.x=mx),px=Math.round(self.scroll.x*self.scrollratio.x)}return self.showCursor(),self.cursorfreezed=!0,!1!==py&&self.doScroll(py),!1!==px&&self.doScrollLeft(px),self.cancelEvent(e)}self.checkarea=!0}),(self.cantouch||self.opt.touchbehavior)&&self.bind(self.win,"mousedown",self.onmousedown),self.bind(self.win,"mouseup",self.onmouseup),self.bind(self.cursor,"mousedown",function(e){self.onmousedown(e),self.rail.drag.locked="v"}),self.bind(self.cursor,"mouseup",function(e){return self.rail.drag=!1,self.hasmoving=!1,self.hideCursor(),self.cancelEvent(e)}),self.cursorh&&(self.bind(self.cursorh,"mousedown",function(e){self.onmousedown(e),self.rail.drag.locked="h"}),self.bind(self.cursorh,"mouseup",function(e){return self.rail.drag=!1,self.hasmoving=!1,self.hideCursor(),self.cancelEvent(e)})),self.bind(document,"mouseup",self.onmouseup),self.bind(document,"mousemove",self.onmousemove),self.onclick&&self.bind(document,"click",self.onclick),self.cantouch||(self.rail.mouseenter(function(){self.showCursor(),self.rail.active=!0}),self.rail.mouseleave(function(){self.rail.active=!1,self.rail.drag||self.hideCursor()}),self.railh&&(self.railh.mouseenter(function(){self.showCursor(),self.railh.active=!0}),self.railh.mouseleave(function(){self.railh.active=!1,self.railh.drag||self.hideCursor()})),self.isiframe||self.bind(self.isie&&self.ispage?document:self.docscroll,"mousewheel",self.onmousewheel),self.bind(self.rail,"mousewheel",self.onmousewheel),self.railh&&self.bind(self.railh,"mousewheel",self.onmousewheelhz)),self.zoom&&(self.zoom.mouseenter(function(){self.showCursor(),self.rail.active=!0}),self.zoom.mouseleave(function(){self.rail.active=!1,self.rail.drag||self.hideCursor()})),self.ispage||self.cantouch||/HTML|BODY/.test(self.win[0].nodeName)||(self.win.attr("tabindex")||self.win.attr({tabindex:tabindexcounter++}),self.win.focus(function(e){domfocus=self.getTarget(e).id||!0,self.hasfocus=!0,self.noticeCursor()}),self.win.blur(function(e){domfocus=!1,self.hasfocus=!1}),self.win.mouseenter(function(e){mousefocus=self.getTarget(e).id||!0,self.hasmousefocus=!0,self.noticeCursor()}),self.win.mouseleave(function(){mousefocus=!1,self.hasmousefocus=!1})),self.onkeypress=function(e){if(self.locked&&0==self.page.maxh)return!0;e=e||window.e;var tg=self.getTarget(e);if(tg&&/INPUT|TEXTAREA|SELECT|OPTION/.test(tg.nodeName)&&(!tg.getAttribute("type")&&!tg.type||!/submit|button|cancel/i.tp))return!0;if(self.hasfocus||self.hasmousefocus&&!domfocus||self.ispage&&!domfocus&&!mousefocus){var key=e.keyCode,ctrl=e.ctrlKey||!1;if(self.locked&&27!=key)return self.cancelEvent(e);var ret=!1;switch(key){case 38:case 63233:ctrl?self.doScroll(0):self.doScrollBy(72),ret=!0;break;case 40:case 63235:ctrl?self.doScroll(self.page.maxh):self.doScrollBy(-72),ret=!0;break;case 37:case 63232:self.railh&&(ctrl?self.doScrollLeft(0):self.doScrollLeftBy(72),ret=!0);break;case 39:case 63234:self.railh&&(ctrl?self.doScrollLeft(self.page.maxw):self.doScrollLeftBy(-72),ret=!0);break;case 33:case 63276:self.doScrollBy(self.view.h),ret=!0;break;case 34:case 63277:self.doScrollBy(-self.view.h),ret=!0;break;case 36:case 63273:self.doScrollTo(0),self.railh&&ctrl&&self.doScrollLeft(0),ret=!0;break;case 35:case 63275:self.doScrollTo(self.page.maxh),self.railh&&ctrl&&self.doScrollLeft(self.page.maxw),ret=!0;break;case 32:self.opt.spacebarenabled&&(self.doScrollBy(-self.view.h),ret=!0);break;case 27:self.zoomactive&&(self.doZoom(),ret=!0)}if(ret)return self.cancelEvent(e)}},self.bind(document,self.isopera?"keypress":"keydown",self.onkeypress),self.bind(window,"resize",self.resize),self.bind(window,"orientationchange",self.resize),self.bind(window,"load",self.resize),!self.ispage&&self.opt.boxzoom&&self.bind(window,"resize",self.resizeZoom),self.istextarea&&self.bind(self.win,"mouseup",self.resize),self.resize()}if("IFRAME"==this.doc[0].nodeName){function oniframeload(e){self.iframexd=!1;try{var doc="contentDocument"in this?this.contentDocument:this.contentWindow.document;doc.domain}catch(e){self.iframexd=!0,doc=!1}if(self.iframexd)return!0;if(self.isiframe&&(self.iframe={html:self.doc.contents().find("html")[0],body:self.doc.contents().find("body")[0]},self.docscroll=$(this.contentWindow)),self.opt.iframeautoresize&&!self.isiframe){self.win.scrollTop(0),self.doc.height("");var hh=Math.max(doc.getElementsByTagName("html")[0].scrollHeight,doc.body.scrollHeight);self.doc.height(hh)}self.onResize(),self.isie7&&self.css($(doc).find("html"),{"overflow-y":"hidden"}),self.css($(doc.body),{"overflow-y":"hidden"}),"contentWindow"in this?self.bind(this.contentWindow,"scroll",self.onscroll):self.bind(doc,"scroll",self.onscroll),self.bind(doc,"mouseup",self.onmouseup),self.bind(doc,"mousewheel",self.onmousewheel),self.railh&&self.bind(self.railh,"mousewheel",self.onmousewheelhz),self.bind(doc,self.isopera?"keypress":"keydown",self.onkeypress),(self.cantouch||self.opt.touchbehavior)&&(self.bind(doc,"mousedown",self.onmousedown),self.cursorgrabvalue&&self.css($(doc.body),{cursor:self.cursorgrabvalue})),self.bind(doc,"mousemove",self.onmousemove),self.zoom&&(self.opt.dblclickzoom&&self.bind(doc,"dblclick",self.doZoom),self.ongesturezoom&&self.bind(doc,"gestureend",self.ongesturezoom))}this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){oniframeload.call(self.doc[0],!1)},500),self.bind(this.doc,"load",oniframeload)}},this.showCursor=function(py){self.cursortimeout&&(clearTimeout(self.cursortimeout),self.cursortimeout=0),self.rail&&(self.autohidedom&&(self.autohidedom.stop().css({opacity:self.opt.cursoropacitymax}),self.railh&&self.railh.stop().css({opacity:self.opt.cursoropacitymax})),void 0!==py&&(self.scroll.y=Math.round(1*py/self.scrollratio.y)),self.cursor.css({height:self.cursorheight,top:self.scroll.y}),self.zoom&&self.zoom.stop().css({opacity:self.opt.cursoropacitymax}),self.cursorh&&self.cursorh.css({width:self.cursorwidth,left:self.scroll.x}))},this.hideCursor=function(tm){self.cursortimeout||self.rail&&self.autohidedom&&(self.cursortimeout=setTimeout(function(){self.rail.active||(self.autohidedom.stop().animate({opacity:self.opt.cursoropacitymin}),self.zoom&&self.zoom.stop().animate({opacity:self.opt.cursoropacitymin}),self.railh&&self.railh.stop().animate({opacity:self.opt.cursoropacitymin})),self.cursortimeout=0},tm||400))},this.noticeCursor=function(tm,py){self.showCursor(py),self.hideCursor(tm)},this.getContentSize=function(){return self.ispage?{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}:self.haswrapper?{w:self.doc.outerWidth()+parseInt(self.win.css("paddingLeft"))+parseInt(self.win.css("paddingRight")),h:self.doc.outerHeight()+parseInt(self.win.css("paddingTop"))+parseInt(self.win.css("paddingBottom"))}:self.iframe?{w:Math.max(self.iframe.html.scrollWidth,self.iframe.body.scrollWidth),h:Math.max(self.iframe.html.scrollHeight,self.iframe.body.scrollHeight)}:{w:self.docscroll[0].scrollWidth,h:self.docscroll[0].scrollHeight}},this.onResize=function(e,page){if(!self.haswrapper&&!self.ispage){var vis="none"!=self.win.css("display");if(vis&&!self.visibility&&self.show(),!vis&&self.visibility&&self.hide(),!self.visibility)return!1}var premaxh=self.page.maxh,premaxw=self.page.maxw,preview_w=(self.view.h,self.view.w);return self.view={w:self.ispage?self.win.width():self.win.innerWidth(),h:self.ispage?self.win.height():self.win.innerHeight()},self.page=page||self.getContentSize(),self.page.maxh=Math.max(0,self.page.h-self.view.h),self.page.maxw=Math.max(0,self.page.w-self.view.w),self.page.maxh==premaxh&&self.page.maxw==premaxw&&self.view.w==preview_w?self:(!self.rail.visibility&&self.page.maxh>=0&&self.show(self.rail),self.railh&&!self.railh.visibility&&self.page.maxw>=0&&self.show(self.railh),0==self.page.maxh&&(self.hide(self.rail),self.scrollvaluemax=0,self.scroll.y=0,self.scrollratio.y=0,self.cursorheight=0,self.setScrollTop(0)),0==self.page.maxw&&(self.hide(self.railh),self.scrollvaluemaxw=0,self.scroll.x=0,self.scrollratio.x=0,self.cursorwidth=0,!self.ishwscroll&&self.setScrollLeft(0)),0==self.page.maxh&&0==self.page.maxw?(self.hide(),self.locked=!0,!1):(self.locked=!1,self.istextarea&&self.win.css("resize")&&"none"!=self.win.css("resize")&&(self.view.h-=20),self.ispage||self.updateScrollBar(self.view),self.cursorheight=Math.min(self.view.h,Math.round(self.view.h*(self.view.h/self.page.h))),self.cursorheight=Math.max(self.opt.cursorminheight,self.cursorheight),self.cursorwidth=Math.min(self.view.w,Math.round(self.view.w*(self.view.w/self.page.w))),self.cursorwidth=Math.max(self.opt.cursorminheight,self.cursorwidth),self.scrollvaluemax=self.view.h-self.cursorheight-self.cursor.hborder,self.railh.width=self.page.maxh>0?self.view.w-self.rail.width:self.view.w,self.scrollvaluemaxw=self.railh.width-self.cursorwidth-self.cursorh.wborder,self.scrollratio={x:self.page.maxw/self.scrollvaluemaxw,y:self.page.maxh/self.scrollvaluemax},self.getScrollTop()>self.page.maxh?self.doScroll(self.page.maxh):(self.scroll.y=Math.round(self.getScrollTop()*(1/self.scrollratio.y)),self.scroll.x=self.ishwscroll?0:Math.round(self.getScrollLeft()*(1/self.scrollratio.x)),self.noticeCursor()),self))},this.resize=this.onResize,this._bind=function(el,name,fn,bubble){self.events.push({e:el,n:name,f:fn}),el.addEventListener?el.addEventListener(name,fn,bubble||!1):el.attachEvent?el.attachEvent("on"+name,fn):el["on"+name]=fn},this.bind=function(dom,name,fn,bubble){var el="jquery"in dom?dom[0]:dom;if(el.addEventListener){if(self.cantouch&&/mouseup|mousedown|mousemove/.test(name)){var tt="mousedown"==name?"touchstart":"mouseup"==name?"touchend":"touchmove";self._bind(el,tt,function(e){if(e.touches.length<2){var ev=e.touches.length>0?e.touches[0]:e;ev.original=e,fn.call(this,ev)}},bubble||!1)}self._bind(el,name,fn,bubble||!1),"mousewheel"==name&&self._bind(el,"DOMMouseScroll",fn,bubble||!1),self.cantouch&&"mouseup"==name&&self._bind(el,"touchcancel",fn,bubble||!1)}else self._bind(el,name,function(e){return(e=e||window.event||!1)&&e.srcElement&&(e.target=e.srcElement),!1!==fn.call(el,e)&&!1!==bubble||self.cancelEvent(e)})},this._unbind=function(el,name,fn){el.removeEventListener?el.removeEventListener(name,fn,!1):el.detachEvent?el.detachEvent("on"+name,fn):el["on"+name]=!1},this.unbindAll=function(){for(var a=0;a<self.events.length;a++){var r=self.events[a];self._unbind(r.e,r.n,r.f)}},this.cancelEvent=function(e){return!!(e=self.cantouch?e.original?e.original:e||!1:e||window.event||!1)&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1,!1)},this.show=function(){return 0!=self.page.maxh&&(self.rail.visibility=!0,self.rail.css("display","block")),0!=self.page.maxw&&(self.railh.visibility=!0,self.railh.css("display","block")),self.visibility=self.rail.visibility||self.railh.visibility,self},this.hide=function(rr){return(rr=rr||self.rail).visibility=!1,rr.css("display","none"),self.visibility=self.rail.visibility||self.railh.visibility,self},this.remove=function(){self.doZoomOut(),self.unbindAll(),self.events=[],self.rail.remove(),self.zoom&&self.zoom.remove(),self.cursor=!1,self.rail=!1,self.zoom=!1;for(var a=0;a<self.saved.css.length;a++){var d=self.saved.css[a];d[0].css(d[1],void 0===d[2]?"":d[2])}return self.saved=!1,self.me.data("__nicescroll",""),self},this.isScrollable=function(e){for(var dom=e.target?e.target:e;dom&&dom.nodeName&&!/BODY|HTML/.test(dom.nodeName);){var dd=$(dom),ov=dd.css("overflowY")||dd.css("overflowX")||dd.css("overflow")||"";if(/scroll|auto/.test(ov))return dom.clientHeight!=dom.scrollHeight;dom=!!dom.parentNode&&dom.parentNode}return!1},this.onmousewheel=function(e){if(self.locked&&0==self.page.maxh)return!0;if(self.opt.preservenativescrolling&&self.checkarea&&(self.checkarea=!1,self.nativescrollingarea=self.isScrollable(e)),self.nativescrollingarea)return!0;if(self.locked)return self.cancelEvent(e);if(self.rail.drag)return self.cancelEvent(e);var delta=0;return(delta=e.detail?-1*e.detail:e.wheelDelta/40)&&(self.scrollmom&&self.scrollmom.y.stop(),self.doScrollBy(delta*self.opt.mousescrollstep)),self.cancelEvent(e)},this.onmousewheelhz=function(e){if(self.locked&&0==self.page.maxw)return!0;if(self.opt.preservenativescrolling&&self.checkarea&&(self.checkarea=!1,self.nativescrollingarea=self.isScrollable(e)),self.nativescrollingarea)return!0;if(self.locked)return self.cancelEvent(e);if(self.rail.drag)return self.cancelEvent(e);var delta=0;return(delta=e.detail?-1*e.detail:e.wheelDelta/40)&&(self.scrollmom&&self.scrollmom.x.stop(),self.doScrollLeftBy(delta*self.opt.mousescrollstep)),self.cancelEvent(e)},this.stop=function(){return self.cancelScroll(),self.scrollmon&&self.scrollmon.stop(),self.cursorfreezed=!1,self.scroll.y=Math.round(self.getScrollTop()*(1/self.scrollratio.y)),self.noticeCursor(),self},self.ishwscroll&&self.hastransition&&self.opt.usetransition?(this.prepareTransition=function(dif,trend){var sp=Math.round(10*self.opt.scrollspeed),ex=Math.min(sp,Math.round(dif/20*self.opt.scrollspeed)),trans=ex>20?self.prefixstyle+"transform "+ex+"ms ease-out 0s":"";return self.lasttransitionstyle&&self.lasttransitionstyle==trans||(self.lasttransitionstyle=trans,self.doc.css(self.transitionstyle,trans)),ex},this.doScroll=function(y,spd){var sy=self.getScrollTop();return y<0&&sy<=0?self.noticeCursor():y>self.page.maxh&&sy>=self.page.maxh?(self.checkContentSize(),self.noticeCursor()):(self.newscrolly=y,self.newscrollspeed=spd||!1,!self.timer&&(self.scrollendtrapped||(self.scrollendtrapped=!0,self.bind(self.doc,self.transitionend,self.onScrollEnd,!1)),void(self.timer=setTimeout(function(){var top=self.getScrollTop(),dif=self.newscrollspeed?self.newscrollspeed:Math.abs(top-self.newscrolly),ms=self.prepareTransition(dif);self.timer=setTimeout(function(){if(self.newscrolly<0&&!self.opt.bouncescroll?self.newscrolly=0:self.newscrolly>self.page.maxh&&!self.opt.bouncescroll&&(self.newscrolly=self.page.maxh),self.newscrolly==self.getScrollTop())self.timer=0,self.onScrollEnd();else{var py=self.getScrollTop();self.timerscroll&&self.timerscroll.tm&&clearInterval(self.timerscroll.tm),ms>0&&(self.timerscroll={ts:(new Date).getTime(),s:self.getScrollTop(),e:self.newscrolly,sp:ms,bz:new BezierClass(py,self.newscrolly,ms,0,1,0,1)},self.cursorfreezed||(self.timerscroll.tm=setInterval(function(){self.showCursor(self.getScrollTop())},60))),self.setScrollTop(self.newscrolly),self.timer=0}},15)},self.opt.scrollspeed))))},this.cancelScroll=function(){if(!self.scrollendtrapped)return!0;var py=self.getScrollTop();return self.scrollendtrapped=!1,self._unbind(self.doc,self.transitionend,self.onScrollEnd),self.prepareTransition(0),self.setScrollTop(py),self.timerscroll&&self.timerscroll.tm&&clearInterval(self.timerscroll.tm),self.timerscroll=!1,self.cursorfreezed=!1,self.noticeCursor(!1,py),self},this.onScrollEnd=function(){self.scrollendtrapped=!1,self._unbind(self.doc,self.transitionend,self.onScrollEnd),self.timerscroll&&self.timerscroll.tm&&clearInterval(self.timerscroll.tm),self.timerscroll=!1,self.cursorfreezed=!1;var py=self.getScrollTop();self.setScrollTop(py),self.noticeCursor(!1,py),py<0?self.doScroll(0,60):py>self.page.maxh&&self.doScroll(self.page.maxh,60)}):(this.doScroll=function(y){var py=self.getScrollTop();self.newscrolly=y,self.bouncescroll||(self.newscrolly<0?(self.newspeedy&&(self.newspeedy.x=0),self.newscrolly=0):self.newscrolly>self.page.maxh&&(self.newspeedy&&(self.newspeedy.x=self.page.maxh),self.newscrolly=self.page.maxh));var mg=Math.floor(Math.abs(y-py)/40);if(mg>0){var ms=100*Math.min(10,mg);self.bzscroll=self.bzscroll?self.bzscroll.update(y,ms):new BezierClass(py,y,ms,0,1,0,1)}else self.bzscroll=!1;if(!self.timer){py==self.page.maxh&&y>=self.page.maxh&&self.checkContentSize();var sync=1;self.cancelAnimationFrame=!1,self.timer=1,function scrolling(){if(self.cancelAnimationFrame)return!0;if(sync=1-sync)return self.timer=setAnimationFrame(scrolling)||1;var sy=self.getScrollTop(),sc=self.bzscroll?self.bzscroll.getNow():self.newscrolly,dr=sc-sy;(dr<0&&sc<self.newscrolly||dr>0&&sc>self.newscrolly)&&(sc=self.newscrolly),self.setScrollTop(sc),sc==self.newscrolly?(self.timer=0,self.cursorfreezed=!1,self.bzscroll=!1,sc<0?self.doScroll(0):sc>self.page.maxh&&self.doScroll(self.page.maxh)):self.timer=setAnimationFrame(scrolling)||1}(),py==self.page.maxh&&y>=py&&self.checkContentSize(),self.noticeCursor()}},this.doScrollLeft=function(x){var px=self.getScrollLeft();self.newscrollx=x,self.bouncescroll||(self.newscrollx<0?(self.newspeedy&&(self.newspeedy.x=0),self.newscrollx=0):self.newscrollx>self.page.maxw&&(self.newspeedy&&(self.newspeedy.x=self.page.maxw),self.newscrollx=self.page.maxw));var mg=Math.floor(Math.abs(x-px)/40);if(mg>0){var ms=100*Math.min(10,mg);self.bzscrollx=self.bzscrollx?self.bzscrollx.update(x,ms):new BezierClass(px,x,ms,0,1,0,1)}else self.bzscrollx=!1;if(!self.timerx){px==self.page.maxw&&x>=self.page.maxw&&self.checkContentSize();var sync=1;self.cancelAnimationFrameX=!1,self.timerx=1,function scrolling(){if(self.cancelAnimationFrameX)return!0;if(sync=1-sync)return self.timerx=setAnimationFrame(scrolling)||1;var sx=self.getScrollLeft(),sc=self.bzscrollx?self.bzscrollx.getNow():self.newscrollx,dr=sc-sx;(dr<0&&sc<self.newscrollx||dr>0&&sc>self.newscrollx)&&(sc=self.newscrollx),self.setScrollLeft(sc),sc==self.newscrollx?(self.timerx=0,self.cursorfreezed=!1,self.bzscrollx=!1,sc<0?self.doScrollLeft(0):sc>self.page.maxw&&self.doScrollLeft(self.page.maxw)):self.timerx=setAnimationFrame(scrolling)||1}(),px==self.page.maxw&&x>=px&&self.checkContentSize(),self.noticeCursor()}},this.cancelScroll=function(){return self.timerx&&clearAnimationFrame(self.timerx),self.timerx=0,self.bzscrollx=!1,self}),this.doScrollBy=function(stp,relative){var ny=0;if(ny=relative?Math.floor((self.scroll.y-stp)*self.scrollratio.y):(self.timer?self.newscrolly:self.getScrollTop(!0))-stp,self.bouncescroll){var haf=Math.round(self.view.h/2);ny<-haf?ny=-haf:ny>self.page.maxh+haf&&(ny=self.page.maxh+haf)}self.cursorfreezed=!1,self.doScroll(ny)},this.doScrollLeftBy=function(stp,relative){if(relative)nx=Math.floor((self.scroll.x-stp)*self.scrollratio.x);else{var sx=self.timer?self.newscrollx:self.getScrollLeft(!0);nx=sx-stp}if(self.bouncescroll){var haf=Math.round(self.view.w/2);nx<-haf?nx=-haf:nx>self.page.maxw+haf&&(nx=self.page.maxw+haf)}self.cursorfreezed=!1,self.doScrollLeft(nx)},this.doScrollTo=function(pos,relative){var ny=relative?Math.round(pos*self.scrollratio.y):pos;ny<0?ny=0:ny>self.page.maxh&&(ny=self.page.maxh),self.cursorfreezed=!1,self.doScroll(pos)},this.checkContentSize=function(){var pg=self.getContentSize();pg.h!=self.page.h&&self.resize(!1,pg)},self.onscroll=function(e){self.rail.drag||self.cursorfreezed||self.delayed("onscroll",function(){self.scroll.y=Math.round(self.getScrollTop()*(1/self.scrollratio.y)),self.railh&&!self.ishwscroll&&(self.scroll.x=Math.round(self.getScrollLeft()*(1/self.scrollratio.x))),self.noticeCursor()},30)},self.bind(self.docscroll,"scroll",self.onscroll),this.doZoomIn=function(e){if(!self.zoomactive){self.zoomactive=!0,self.zoomrestore={style:{}};var lst=["position","top","left","zIndex","backgroundColor","marginTop","marginBottom","marginLeft","marginRight"],win=self.win[0].style;for(var a in lst){var pp=lst[a];self.zoomrestore.style[pp]=void 0!==win[pp]?win[pp]:""}self.zoomrestore.style.width=self.win.css("width"),self.zoomrestore.style.height=self.win.css("height"),self.zoomrestore.padding={w:self.win.outerWidth()-self.win.width(),h:self.win.outerHeight()-self.win.height()},self.isios4&&(self.zoomrestore.scrollTop=$(window).scrollTop(),$(window).scrollTop(0)),self.win.css({position:self.isios4?"absolute":"fixed",top:0,left:0,"z-index":self.opt.zindex+100,margin:"0px"});var bkg=self.win.css("backgroundColor");return(""==bkg||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(bkg))&&self.win.css("backgroundColor","#fff"),self.rail.css({"z-index":self.opt.zindex+110}),self.zoom.css({"z-index":self.opt.zindex+112}),self.zoom.css("backgroundPosition","0px -18px"),self.resizeZoom(),self.cancelEvent(e)}},this.doZoomOut=function(e){if(self.zoomactive)return self.zoomactive=!1,self.win.css("margin",""),self.win.css(self.zoomrestore.style),self.isios4&&$(window).scrollTop(self.zoomrestore.scrollTop),self.rail.css({"z-index":self.ispage?self.opt.zindex:self.opt.zindex+2}),self.zoom.css({"z-index":self.opt.zindex}),self.zoomrestore=!1,self.zoom.css("backgroundPosition","0px 0px"),self.onResize(),self.cancelEvent(e)},this.doZoom=function(e){return self.zoomactive?self.doZoomOut(e):self.doZoomIn(e)},this.resizeZoom=function(){if(self.zoomactive){var py=self.getScrollTop();self.win.css({width:$(window).width()-self.zoomrestore.padding.w+"px",height:$(window).height()-self.zoomrestore.padding.h+"px"}),self.onResize(),self.setScrollTop(Math.min(self.page.maxh,py))}},this.init()}(opt,$(this)),$(this).data("__nicescroll",nice)),ret.push(nice)}),1==ret.length?ret[0]:ret},window.NiceScroll={getjQuery:function(){return jQuery}}}(jQuery),function($,w$){function slideshow(params,xml){var self=this;self.id=params.containerId,this.params={bgcolor:params.pcolor||xml.find("color").text(),viewText:xml.find("viewText").text(),slideText:xml.find("slideText").text(),duration:1e3*parseInt(xml.find("minimumDuration").text()),slideshow:!1},this.cards=[],this.cards.current=0,xml.find("slidedata").each(function(){self.cards.push({title:_parse_string.call($(this).find("title").text()),slide:_parse_string.call($(this).find("content").text()),image:$(this).find("slide").text(),audio:$(this).find("audio").text(),width:parseInt($(this).find("width").text()),height:parseInt($(this).find("height").text())})}),this.wrapper=$("#"+self.id).css({width:"600px",height:"540px","background-color":"#"+self.params.bgcolor,margin:"0",padding:"20px",border:"1px solid #7094b7","line-height":"110%"}),$("#"+this.id).hasClass("slideshow-deferred")||(this.wrapper.parents(get_greymatter_class_name()).defer_until_visible(function(){this._ready=!1;for(var _total=0,i=this.cards.length;i--;)this.cards[i].image&&_total++,this.cards[i].audio&&_total++;var onload=$.threadlock(_total,this._build_view.bind(this));for(i=this.cards.length;i--;){var card=this.cards[i];card.audio&&this._load_media(card.audio,onload),card.image&&this._load_mediaImg(card.image,onload)}}.bind(this)),$("#"+this.id).addClass("slideshow-deferred"))}w$.softchalkslide={},w$.softchalkslide.init=function(xml,params){return new slideshow(params,$(xml))},slideshow.prototype._load_mediaImg=function(link,onload){var img=new Image;img.onload=onload,img.src=link},slideshow.prototype._load_media=function(link,onload){$.ajax({url:link,cache:!1,success:onload,error:onload})},slideshow.prototype._build_view=function(){var self=this,wrapper=(this.params,this.wrapper.click(function(event){"SELECT"!=event.target.tagName&&$("#inputf_"+self.id).focus()})),id=self.id,skeleton=$(['<table border="0" cellpadding="0" cellspacing="0">','  <tr height="450px"><td id="view-'+id+'"></td></tr>',"</table>",'<table border="0" cellpadding="0" cellspacing="0">','  <tr height="26px">','    <td id="prev-'+id+'" class="slideShowPrev" width="30px" style="cursor:pointer;"></td>','    <td id="select-'+id+'" width="400px"></td>','    <td id="next-'+id+'" class="slideShowNext" width="30px" style="cursor:pointer"></td>','    <td id="start-stop-'+id+'" width="140px" style="cursor:pointer;"></td>',"  </tr>","</table>",'<table border="0" cellpadding="0" cellspacing="0"  class="slideShowJp">','  <tr height="38px"><td></td></tr>',"</table>",'<table border="0" cellpadding="0" cellspacing="0" class="slideShowJp">','  <tr height="30px">','    <td width="150px" style="cursor:pointer;"></td>','    <td id="view-text-'+id+'"width="300px"></td>','    <td width="150px" style="cursor:pointer"></td>',"  </tr>","</table>"].join("")).css({width:"600px","border-spacing":"0px"});self.image=$('<img src="sclb_extras/loading.gif"/>'),self.slide=$("<div/>").css({"text-align":"left","font-family":"Verdana","font-size":"12px","background-color":"#fff",margin:"0",padding:"5px",border:"2px groove #c3c3c3",overflow:"hidden",width:"596px",height:"436px"}).hide(),self.slide_select=$('<select size="1"></select>').css({width:"380px",border:"1px solid #c3c3c3","-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px"}).bind("enable",function(){$(this).removeAttr("disabled")}).bind("disable",function(){$(this).attr("disabled","true")}).trigger("disable").change(self.select.bind(self));for(var i=0;i<self.cards.length;i++)$('<option value="'+i+'"></option>').html(self.cards[i].title).appendTo(self.slide_select);function add_slide_events($el,onclick){return $el.css({cursor:"pointer",height:"14px","font-size":"12px","text-align":"center","font-family":"Verdana",padding:"2px 0",margin:"auto",border:"3px double #919191","-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px","line-height":"100%","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-o-user-select":"none","user-select":"none"}).hover(function(){$(this).hasClass("bttn-disabled")||$(this).css({border:"3px double #89cc73"})},function(){$(this).hasClass("bttn-disabled")||$(this).css({border:"3px double #919191"})}).bind("disable",function(){$(this).addClass("bttn-disabled").css({cursor:"default"})}).bind("enable",function(){$(this).removeClass("bttn-disabled").css({cursor:"pointer"})}).click(function(e){$(this).hasClass("bttn-disabled")||onclick()}).trigger("disable")}this.slide_show=$("<div>Start Slideshow</div>"),add_slide_events(this.slide_show,this.slideshow.bind(this)).css({width:"120px"}),this.slide_view=$("<div/>").html(this.params.viewText),add_slide_events(this.slide_view,this.change_view.bind(this)).css({width:"180px"});var _naive_center_css={"vertical-align":"middle","text-align":"center"};function stylenav($el,onclick){return $el.click(function(){$(this).hasClass("bttn-disabled")||onclick()}).bind("enable",function(){$(this).removeClass("bttn-disabled").css({"background-position":"0px -26px",cursor:"pointer"})}).bind("disable",function(){$(this).addClass("bttn-disabled").css({"background-position":"0px 0px",cursor:"default"})}).trigger("disable")}skeleton.find("#view-"+id).css(_naive_center_css).append(this.image,this.slide),skeleton.find("#select-"+id).css(_naive_center_css).append(this.slide_select),skeleton.find("#start-stop-"+id).css(_naive_center_css).append(this.slide_show),skeleton.find("#view-text-"+id).css(_naive_center_css).append(this.slide_view),self.control={},self.control.prev=stylenav(skeleton.find("#prev-"+id),self.prev.bind(self)),self.control.next=stylenav(skeleton.find("#next-"+id),self.next.bind(self)),self.jpCont=$('<div style="width:0;height:0"></div>');var jpCont=self.jpCont,jpPlayer=$('<div class="jp-seek-bar"></div>').append($('<div class="jp-play-bar"></div>').append($("<div></div>").css({"background-color":"#e4f8dc",height:"13px"}))).append($("<div class='jp-current-time'>00.00</div>").css({position:"relative",float:"right",height:"13px",width:"100%","vertical-align":"center","text-align":"right","font-size":"10px",top:"-20px","margin-right":"3px"})),vol_wrapper=$("<div></div>").css({position:"relative",margin:0,padding:0,width:"150px",height:"30px",overflow:"auto"}),vol_jp_volume_max=$("<div class='jp-volume-max'></div>").css({position:"absolute",top:"2px",right:"0px",width:"12px",height:"12px",margin:"3px"}).hover_class_toggle("jp-volume-max-hover"),vol_jp_volume_bar=$("<div class='jp-volume-bar'></div>").css({position:"absolute",top:"2px",right:"26px",width:"51px",height:"30x",margin:"3px"}).append($("<div class='jp-volume-bar-over'></div>"),$("<div></div>").css({height:"2px","padding-left":"10px",position:"relative",border:"1px solid #cdd4d4",top:"2px",left:"6px"}),$("<div class='jp-volume-bar-value'></div>")),vol_jp_volume_min=$("<div class='jp-volume-min'></div>").css({position:"absolute",top:"2px",right:"78px",width:"9px",height:"12px",margin:"3px"}).hover_class_toggle("jp-volume-min-hover").click(function(){jpCont.jPlayer("volume",0)});vol_wrapper.append(vol_jp_volume_max,vol_jp_volume_bar,vol_jp_volume_min),skeleton.eq(3).find("td").eq(2).css({"vertical-align":"top"}).append(vol_wrapper),self.playStop=$('<div class="play"></div>').hover(function(){$(this).css({border:"3px double #89cc73"})},function(){$(this).css({border:"3px double #919191"})}).click(function(){self.is_playing()?self.pause():self.is_at_audio_end()?self.play_from_start():self.play_from_current()});var play_left=$("<div></div>").css({width:"19px",height:"24px",float:"left"}).hover_class_toggle("left_hover").click(function(){jpCont.jPlayer("playHead",0)}).append($('<div class="left"></div>')),play_right=$("<div></div>").css({width:"19px",height:"24px",float:"left"}).hover_class_toggle("right_hover").click(function(){jpCont.jPlayer("playHead",100)}).append($('<div class="right"></div>')),play_back=$('<div class="p_back"></div>').append(play_left,play_right);skeleton.eq(3).find("td").eq(0).css({"vertical-align":"center","text-align":"right",visibility:"hidden"}).append(self.playStop,play_back),skeleton.eq(2).find("td").append(jpCont).append(jpPlayer),self.control.audioPlayer=jpCont,self.audioDivs=[],self.audioDivs.push(skeleton.eq(3).find("td").eq(0)),self.audioDivs.push(jpPlayer),self.audioDivs.push(skeleton.eq(3).find("td").eq(2));var inpC=$('<input type="button" id="inputf_'+self.id+'"/>').css({width:"1px",height:"1px",border:"0",position:"absolute","z-index":"-1"}).focusin(function(){self.wrapper.addClass("sc-selectedQuestion")}).focusout(function(){self.wrapper.removeClass("sc-selectedQuestion")}).bind("keydown",{self:self},self.handleKeys);wrapper.append(inpC),wrapper.append(skeleton),jpCont.jPlayer({swfPath:"lib/jPlayer",wmode:"window",supplied:"mp3, oga",solution:"html",preload:"none",volume:.66,muted:!1,backgroundColor:"#000000",cssSelectorAncestor:"#"+self.id,cssSelector:{videoPlay:".jp-video-play",play:".jp-play",pause:".jp-pause",stop:".jp-stop",seekBar:".jp-seek-bar",playBar:".jp-play-bar",volumeBar:".jp-volume-bar",volumeBarValue:".jp-volume-bar-value",volumeMax:".jp-volume-max",currentTime:".jp-current-time",duration:".jp-duration",fullScreen:".jp-full-screen",restoreScreen:".jp-restore-screen",gui:".jp-gui",noSolution:".jp-no-solution"},errorAlerts:!1,warningAlerts:!1,ready:function(event){self.update()},ended:function(){self.playStop.removeClass("playStop"),self.cards.current==self.cards.length-1&&self.stop_slideshow(),self.params.slideshow&&self.next()}}),$(".jp-volume-max, .jp-volume-bar, .jp-volume-min").show().children().show()};var _parse_string=function(){return decodeURIComponent(this.replace(/\+/gi," "))};slideshow.prototype.is_playing=function(){return!this.jpCont.data("jPlayer").status.paused},slideshow.prototype.pause=function(){this.sound_active=!1,this.playStop.removeClass("playStop"),this.jpCont.jPlayer("pause"),this.params.slideshow&&this.stop_slideshow()},slideshow.prototype.is_at_audio_end=function(){return this.jpCont.data("jPlayer").status.currentPercentAbsolute>99},slideshow.prototype.play_from_start=function(){this.jpCont.jPlayer("playHead",0),this.play_from_current()},slideshow.prototype.play_from_current=function(){this.sound_active=!0,this.jpCont.jPlayer("play"),this.playStop.addClass("playStop")},slideshow.prototype.handleKeys=function(e){var self=e.data.self;switch(e.keyCode){case 39:self.next();break;case 37:self.prev();break;case 76:e.altKey&&self.slideshow();break;case 77:e.altKey&&self.change_view();break;case 38:var vol=(volBarValue=$(self.wrapper).find(".jp-volume-bar-value")).width()/volBarValue.parent().width();vol=Math.min(vol+.1,1),self.jpCont.jPlayer("volume",vol);break;case 40:var volBarValue;vol=(volBarValue=$(self.wrapper).find(".jp-volume-bar-value")).width()/volBarValue.parent().width();vol=Math.max(vol-.1,0),self.jpCont.jPlayer("volume",vol);break;case 71:e.altKey&&self.playStop.trigger("click");break;case 74:e.altKey&&self.jpCont.jPlayer("playHead",0);break;case 75:e.altKey&&self.jpCont.jPlayer("playHead",100);break;default:return!0}e.preventDefault()},slideshow.prototype.has_audio=function(){return this.cards[this.cards.current].audio},slideshow.prototype.change_view=function(){this.image.is(":visible")?(this.image.hide(),this.slide.show(),this.slide_view.html(this.params.slideText)):(this.image.show(),this.slide.hide(),this.slide_view.html(this.params.viewText))},slideshow.prototype.next=function(){var c=this.cards;c.current!=c.length-1?(c.current++,this.update()):this.params.slideshow&&this.stop_slideshow()},slideshow.prototype.prev=function(){var c=this.cards;0!==c.current&&(c.current--,this.update())},slideshow.prototype.select=function(){this.cards.current=parseInt(this.slide_select.val()),this.update()},slideshow.prototype.start_slideshow=function(){var c=this.cards;this.params.slideshow=!0,this.sound_active=!0,c.current!=c.length-1||this.has_audio()&&!this.is_at_audio_end()||(c.current=0,this.update()),this.has_audio()?(this.is_at_audio_end()&&this.next(),this.play_from_current()):this.params.slideshowI=setInterval(this.next.bind(this),this.params.duration),this.slide_show.html("Stop Slideshow")},slideshow.prototype.stop_slideshow=function(){this.params.slideshow=!1,this.sound_active=!1,this.has_audio()&&this.is_playing()&&this.pause(),clearInterval(this.params.slideshowI),this.slide_show.html("Start Slideshow")},slideshow.prototype.slideshow=function(){this.params.slideshow?this.stop_slideshow():this.start_slideshow()},slideshow.prototype.update=function(){this.slide_select.trigger("enable"),this.slide_show.trigger("enable"),this.slide_view.trigger("enable");var next_event,prev_event,c=this.cards,n=c.current;if(this.image.attr({src:c[n].image,width:c[n].width,height:c[n].height}),this.slide.html(c[n].slide),this.slide_select.val(n),this.has_audio()){this.params.slideshow&&clearInterval(this.params.slideshowI),this.control.audioPlayer.jPlayer("setMedia",{mp3:c[n].audio,oga:c[n].audio.substring(0,c[n].audio.lastIndexOf("."))+".ogg"}),this.is_playing()||this.control.audioPlayer.jPlayer("play",0).jPlayer("pause").jPlayer("playHead",0),this.sound_active&&this.play_from_start();for(var i=0;i<this.audioDivs.length;i++)this.audioDivs[i].css({visibility:"visible"})}else{this.control.audioPlayer.jPlayer("stop");for(i=0;i<this.audioDivs.length;i++)this.audioDivs[i].css({visibility:"hidden"});this.params.slideshow&&(clearInterval(this.params.slideshowI),this.has_audio()||(this.params.slideshowI=setInterval(this.next.bind(this),this.params.duration)))}next_event=prev_event="enable",n==c.length-1&&(next_event="disable"),0==n&&(prev_event="disable"),this.control.prev.trigger(prev_event),this.control.next.trigger(next_event)},slideshow.prototype.reset=function(){return!1},slideshow.prototype.save_state=function(){return""},slideshow.prototype.load_state=function(){arguments[0].split(";").reverse()},$.shuffle=function(arr){for(var j,x,i=arr.length;i;j=parseInt(Math.random()*i),x=arr[--i],arr[i]=arr[j],arr[j]=x);}}(jQuery,window);
